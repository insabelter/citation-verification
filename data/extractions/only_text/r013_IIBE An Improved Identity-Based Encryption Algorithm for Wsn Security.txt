Introduction
WSN is a wireless network composed of sensor nodes in the form of self-organization, which collects and processes the relevant information of monitored objects in the target area and sends it to the observer  [1] [2] [3] [4] [5] [6] [7] [8] [9] [10] . As early as the middle of the last century, there appeared a network which combined sensors with wireless transmitters and carried out real-time data acquisition, which was the prototype of WSN. WSN began to mature, following the technical progress and the deepening of related research  [11] [12] [13] [14] . e application field of WSN has gradually developed from the military field to all walks of life, such as agricultural production, environmental monitoring, cultural relics protection, and medical care  [15] . Information encryption is the most core and basic technical method to protect information security  [16] [17] [18] . e encryption process of data is to use encryption key and encryption algorithm to convert plaintext into ciphertext form that other users cannot understand, while decryption is the reverse process, using decryption key and decryption algorithm to recover the ciphertext into plaintext. Encrypted text is transmitted between users, and only the user with the decryption key can decrypt the encrypted text to obtain the plaintext  [19] [20] [21] . In general, cryptosystems are divided into two types: one is symmetric cryptosystems and the other is public key cryptosystems. Since WSN is usually deployed in an unattended environment, besides eavesdropping attacks, denial of service attacks, and other attacks faced by ordinary networks, it also faces the problems that WSN nodes are easy to be captured and counterfeited, and transmitted data are easy to be eavesdropped and tampered  [22] [23] [24] . Currently, WSN has mediocre solution when facing the above security problems. Before these problems are solved, users cannot easily accept and deploy a WSN with security and data protection, which greatly limits WSN practical application. In order to address the challenge of WSN security, IIBE is proposed. e main contributions of this paper are as follows: (1) Compared with the traditional public key encryption, this algorithm does not need a public key certificate and avoids the management of certificates (2) Compared with other existing identity-based encryption algorithms, this algorithm solves the problem of key escrow and key revocation e rest of the paper is organized as follows. In Section 2, a literature review is studied in detail, while Section 3 provides the detailed methodology. Section 4 provides detailed results and discussion. Finally, the paper is concluded in Section 5.

Literature Review
At present, scholars have studied the improvement of symmetric/asymmetric encryption algorithms, the combination of various encryption algorithms, and some innovative encryption ideas. Mostafaei et al.  [22]  provided a solution to the flooding attack in WSN through message digest algorithm combined with public key encryption, which improved the network's ability to detect data packet transmission. NS2 simulation results show that this method is effective in preventing flooding attacks. However, this method only signs the data transmitted by nodes to prevent flooding attacks and has limited preventive effect on data eavesdropping attacks, so it needs to be combined with other encryption methods in practical applications. Rachkidy et al.  [23]  proposed a method of data storage combined with homomorphic encryption for some wireless sensor networks with insensitive real-time data, which is called DIOS. In some WSN (such as underwater sensor networks), people are more concerned about the whole data, rather than the data at a certain time. In view of this situation and considering that a large amount of data may cause loss to the sensor nodes if it is transmitted for a long time and a long distance, this literature puts forward that the data should be stored in a relay node in advance and preprocessed, so as to avoid the scattered and uninterrupted transmission of data. At the same time, homomorphic encryption is adopted to ensure security. is method is effective in some occasions, saving energy, and data can be stored safely. However, it is not suitable for most net-laying environments and has certain limitations. Daniela and Giovanni  [24]  improved the application of AES in WSN, put forward the encryption idea of seven rounds of encryption, and combined with the table lookup method to optimize each round of operation. e results of simulation test show that the algorithm has greatly improved operation efficiency, and the speed is 13 times higher than that of common AES algorithm with less than 1 KB storage space. Although the security is lower than the traditional AES encryption algorithm, it is still suitable for WSN with limited energy. All the above methods have defects, which cannot fully meet the needs of practical application of wireless sensor networks. To solve the above problems, according to the characteristics of WSN and based on the idea of identity-based encryption, an improved identity-based encryption algorithm (IIBE) is proposed, which can effectively simplify the key generation process, reduce the network traffic, and improve the network security.

Methodology


Analysis of WSN Network Topology and Its Security
Problems. According to ZigBee protocol, WSN has three topologies: star topology, tree topology, and mesh topology, as shown in Figure  1 . e network specified by ZIGBEE protocol is composed of main coordinator nodes, router nodes, and terminal nodes, and there is only one main coordinator network. Every device in the network, including master device and slave device, has a unique 64-bit long address (IEEE address) built in at the factory. After the network is built, each slave device will be randomly assigned to a unique 16-bit short address code in the network by the master coordinator. e long address code is an absolute address, while the short address code is a relative address. Based on a large amount of data and practical operation experience of wireless sensor networks, it can be concluded that the existing wireless sensor networks have problems such as limited energy, limited computing and storage capacity, periodicity of data collection, asymmetry of data flow, and limited communication channel width. Taking the WSN network designed by ZIGBEE protocol as an example, the more serious attack forms are (1) black hole attack, (2) flooding attack, (3) data eavesdropping attack, and (4) server key escrow problem. Although the common asymmetric encryption algorithm can be used for identity authentication, because the authentication process is complicated and the key distribution is very inconvenient, people have been looking for an alternative method with efficient authentication capability.

Traditional IBE Encryption
Algorithm. In 1984, Shamir et al. first proposed the concept of identity-based encryption (IBE), but in 2001, IBE was realized by Boneh et al. using bilinear pairings on elliptic curves  [25] . However, the current IBE algorithm still has some problems, such as too complicated operation and key escrow. How to improve IBE algorithm and make it really applied in WSN is a hot research topic at present. e common IBE scheme usually consists of four processes: initialization, private key generation and distribution, encryption, and decryption  [26] . Among them, the private key needs to be assigned to the user in advance through the secure channel, while the public key can be generated according to the public information of the user. e workflow of IBE mechanism is shown in Figure  2 . e core of traditional IBE encryption algorithm is bilinear pairing operation, which needs to go through multiple rounds of polynomial iterative process, and the computational complexity is extremely high.

Improved Identity-Based Encryption Algorithm lIBE.
On the basis of studying the encryption structure of traditional IBE algorithm, a scheme IIBE is proposed to solve the above key escrow and revocation problems. e design idea is as follows: the user's private key in the system is divided into two parts, one part is controlled by private key generator (PKG), and the other part is controlled by users themselves. When decrypting, PKG firstly decrypts the received ciphertext with a partial private key and gives the result to the user, and then, the user decrypts it with his own partial private key to obtain the final decrypted plaintext. If a user's key needs to be revoked, PKG does not help the user to decrypt it preliminarily. Because PKG does not master all the private keys, it can avoid the key escrow problem. IIBE consists of five processes: system initialization, key extraction, public key extraction, encryption, and decryption. If ciphertext C is obtained by encryption algorithm (with params, P ID , and plaintext M as input), then running decryption algorithm (with params, D ID , X SID , and ciphertext C as input) will definitely get correct plaintext M. A. encrypt data with public key Bob@.com Send encrypted data B.Bob requests his private key from the server C. the server grants Bob the private key Bob Smith D. Decrypt data with private key Figure 2: Schematic diagram of IBE workflow. e specific operation process of IIBE encryption algorithm initialization and encryption and decryption is shown in Figure  3 . e parameter design of IIBE encryption algorithm is shown in Table  1 . e functions of each parameter are (1) Public parameter s: the public parameter is randomly generated by the server, not disclosed, only reserved by the server, and used to issue the node private key. However, participates in all encryption, decryption, and authentication operations thereafter [27]. (2) Primitive element P: primitive element belongs to a point in the finite field of elliptic curve, but it plays an extremely important role in IIBE algorithm, so it is an element alone. All points of finite fields can be generated by p. (3) Public information Q bob : it is some traceable and unchangeable information of nodes. (4) Public key Q: it is generated by public information Q bob , which is a point on the elliptic curve finite field, and can be generated by the node itself or other nodes according to the public information. (5) Random parameter r: it is randomly generated by nodes, participating in the ciphertext generation process and participating in the decryption process in the form of rP. (6) Hash function Hash: map a string to a certain point in a finite field [28, 29]. (7) Mapping function number f: convert the string into the corresponding binary code string. (8) Node private key E: it is generated by the server and assigned to the node. (9) Original plaintext D: it needs to be mapped to binary code string for encryption and decryption. 3.4. Comparative Analysis of Complexity. We compare IIBE, AES, IBE, and DIOS from two aspects of key security and computational complexity. e comparison results of key security are shown in Table 2. It can be seen from Table  2  that the key security of the proposed IIBE algorithm is the highest. en, compare the computational complexity of different algorithms, as shown in Table  3 . It can be seen from Table  3  that, compared with other algorithms, the computational complexity of the proposed IIBE algorithm in system initialization, helping device, and user key update is reduced from O (log N) to o (1), which means that the complexity of the proposed IIBE algorithm is the lowest.

Experimental Results and Analysis
4.1. Experimental Setup. In the experiment, the WSN node adopts CC2530 sensor network node of TI (Texas instruments) company  [30] , which has an enhanced C51 single chip microcomputer and 8k RAM storage space, and is powered by two No.5 batteries  [31, 32] . WSN nodes are shown in Figure  4 . e actual network topology of IIBE is shown in Figure  5 . Settings of WSN network parameters are shown in Table  4 . Ten CC2530 nodes are used for network deployment, and all IIBE nodes in WSN are not set to sleep. All collected data are stored in the MySql database on the server side. en, it will be tested from three aspects: energy consumption, network communication capability, and security capability.

Energy Consumption Test.
Firstly, the energy consumption of several encryption algorithms is tested. e IIBE algorithm performs node authentication every 30 minutes and key update every two hours in order to approach the actual network deployment situation as much as possible. A total of about 100,000 pieces of actual data were collected by the experimental WSN network, and the fitting curve obtained by sorting out is shown in Figure  6 . e ordinate of Figure  6  shows the average voltage of nodes in the actual distribution network, in volts. e abscissa is the network running time in hours. It can be seen that when the key length is 30 bits, AES encryption supported by CC2530 hardware has the longest duration, and the actual duration of IIBE encryption is about 83 hours, which is more than 10 hours shorter than AES encryption. However, considering that IIBE here sets up internode authentication every half hour, which is different from AES's simple encryption and decryption operation, it can be considered that IIBE can meet the energy consumption requirements when the key length is 30 bits. Generally speaking, the energy consumption of IIBE algorithm is weaker than that of AES, but it can still last for a long time and basically meet the design goals.

Communication Performance Test.
In the experiment, the data that can be effectively counted are the amount of data sent by WSN nodes and received by the server, so compared with the concept of packet loss rate, the concept of data reception rate can describe the actual experiment more accurately. e calculation method of data reception rate  [33]  is as follows: Pr � 􏽐 n i�0 n (i)receive 􏽐 n i�0 n (i)send , ( 1 ) where n (i) receive represents the number of data received by the server from ith node and b represents the number of data sent by ith node. On CC2530 WSN node, the data receiving rates of several methods with 30-bit key are tested, and about 40,000 experimental data are obtained. e statistical fitting curve of the results is shown in Figure  7 . It can be seen from Figure  7  that when the network scale increases, the trend of traffic not only depends on the algorithm itself but also is greatly affected by the network layout. e random distribution method adopted in the experiment makes some nodes close to the coordinator Initialization Server Calculate sP as a public parameter and disclose it to all nodes Save the public parameter sP and the node private key E. key E Node Sending sP Encryption and decryption & authentication Server Get plaintext D=f (m) Node Choose r at random and calculate rP. Compute ciphertext Calculate Q=Hash (Q bob ) and calculate the node private key E. Generating a random number s as a secret parameter Calculate m=Hash (sQ,rP) . Choose plaintext d randomly and calculate m=f (D)     100 98 96 94 92 90 88 86 84 82 80 Data reception rate (%) 20 40 60 80 100 120 140 160 180 Time (minutes) AES IIBE DIOS IBE Figure 7: Comparison of network reception rate. consume more energy and die faster, and the death of these nodes also affects the communication between other nodes and the coordinator. Because IIBE has a key exchange process in the initial stage, there is a large amount of communication in the initial stage. With the steady state of the network, the traffic volume of IIBE network is gradually stable. e algorithms such as DIOS and IBE, which have a large amount of communication, have a low reception rate, while the reception rate of IIBE and AES is higher than that of DIOS, so the reception rate of IIBE algorithm is basically acceptable.

Conclusion
Based on the encryption structure of traditional IBE algorithm, this paper proposes a scheme IIBE to solve the above key escrow and revocation problems. e design idea is as follows; the user's private key in the system is divided into two parts: one part is controlled by PKG and the other part is controlled by users themselves. Compared with the traditional public key encryption, this algorithm does not need public key certificates and avoids the management of certificates. Compared with identity-based public key encryption, this algorithm solves the problems of key escrow and key revocation. e whole system test shows that compared with traditional encryption algorithm, the proposed IIBE algorithm has the characteristics of low energy consumption, high encryption strength, and strong authentication capability and is suitable for WSN deployment environment with high security requirements. In the future, the performance of IIBE encryption algorithm will be tested in a larger area of WSN network, and the security of various attacks will be analyzed.