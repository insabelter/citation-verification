Introduction
Geological evidence suggests that for multiple time periods during Earth's history the oceans were entirely, or almost entirely, covered by sea glaciers  (Kirschvink 1992; Hoffman et al. 1998; Hoffman and Li 2009; Hoffman and Schrag 2002; Pierrehumbert et al. 2011 ). These periods are commonly referred to as ''snowball Earth'' events. While many studies have simulated the atmospheric and climate dynamics of snowball Earth events (e.g.,  Wetherald and Manabe 1975; Pierrehumbert 2005; Abbot and Pierrehumbert 2010; Voigt and Marotzke 2010; Voigt et al. 2012; Abbot et al. 2013; Rose 2015) , the ocean dynamics have received relatively little attention. A number of studies have presented coupled atmosphere-ocean simulations of snowball states (e.g.,  Poulsen et al. 2001; Marotzke and Botzet 2007; Voigt and Marotzke 2010; Voigt et al. 2011; Ferreira et al. 2011; Rose 2015) . However, the ocean model setup and parameters in these simulations are based on the present-day ocean; yet, basic physical considerations make clear that the ocean circulation in a snowball world would be very different from the present day. In particular, the source of mechanical energy for the present-day ocean circulation is provided primarily by surface stress from the winds blowing over the ocean  (Wunsch and Ferrari 2004; Ferrari and Wunsch 2009) . During a snowball event, however, the ocean is shielded from atmospheric wind stress by a solid ice sheet, and the circulation is likely driven primarily by geothermal heating at the seafloor (typically ignored in the aforementioned studies). Because heat is supplied at higher temperatures and pressures near the seafloor, and lost at lower temperatures and pressures at the bottom of the ice sheet, mechanical energy can be extracted via the principle of a heat engine. However, the rate of mechanical energy extraction is expected to be much smaller than the power provided to the large-scale circulation in the present-day ocean by wind stress, which provides a crucial constraint on the strength of the ocean circulation and mixing rates (e.g.,  Ferrari and Wunsch 2009) . A more focused analysis of snowball Earth ocean circulation was recently spearheaded in a series of papers by  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  and  Ashkenazy and Tziperman (2016) , who use a hierarchy of models to study the ocean circulation under a thick ice sheet. In  Ashkenazy et al. (2013)  and  Ashkenazy et al. (2014) , global two-and three-dimensional ocean models are coupled to a dynamic sea glacier model. The simulations of  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  indicate interesting dynamics mostly in the equatorial region, where a vigorous overturning circulation with associated zonal jets develops within a few degrees of the equator. The rest of the ocean is unstratified, with vertical heat transport accomplished by parameterized convection and meridional heat and salt fluxes accomplished by parameterized eddy fluxes. The eddy transport of heat and salt in these noneddying simulations is parameterized by horizontal eddy diffusion, which differs from the  Gent and McWilliams (1990) -type eddy parameterizations typically used in simulations of the present-day ocean. While horizontal diffusion generates irreversible horizontal mixing, the effect of the  Gent and McWilliams (1990)  (GM) parameterization is a reversible rearrangement of water masses, which acts to release available potential energy and transports heat not just horizontally but also vertically. Whether a GM parameterization or simple horizontal diffusion is more appropriate in a snowball Earth ocean remains an open question. Motivated by the results of the coarse-resolution simulations,  Ashkenazy et al. (2013)  and  Ashkenazy and Tziperman (2016)  discuss additional higher-resolution simulations using an equatorial ocean sector model coupled to a static ice sheet. In addition to confirming the vigorous equatorial overturning circulation and jets, the simulations exhibit a well-developed turbulent eddy field. Horizontal mixing rates are estimated to be comparable to the present-day ocean, while vertical mixing rates are found to be much larger, with weak or vanishing vertical stratification. However, the simulated domain only extends over the tropical region between 208S and 208N, and the resolution of 1/88 is adequately eddy permitting only in an even smaller region around the equator, as the deformation radius decreases rapidly away from the equator because of the very weak stratification.  Ashkenazy and Tziperman (2016)  present a diagnostic analysis of the Lorenz energy cycle, pointing toward the importance of both baroclinic and barotropic instabilities in generating the eddy field in the equatorial region. However, no predictive theory is brought forward to explain the surprisingly large eddy kinetic energy (EKE) and turbulent eddy diffusivities. The work of  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  and  Ashkenazy and Tziperman (2016)  represents an important first step toward understanding the ocean circulation during snowball Earth events, but more work is needed to fully appreciate the properties of the turbulent flow outside of the equatorial region. This is the goal of this study. Rather than presenting additional global-scale simulations, the focus of this paper is to improve our theoretical understanding of extratropical ocean dynamics in a snowball Earth ocean. What are the expected dominant dynamical processes? What are the energetic constraints? And what does this tell us about the largescale mean state and the transport of heat, salt, and other constituents? The results are expected to provide 1) some theoretical constraints on the ocean mean state and turbulent circulation during a snowball Earth event and 2) a basis for the formulation of ocean eddy parameterizations for use in future snowball world climate simulations. As in  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  and  Ashkenazy and Tziperman (2016) , the focus here will be on the so-called hard snowball scenario, where the entire ocean is covered by an ice sheet. Possible implications of the results for a ''Waterbelt''  (Hyde et al. 2000)  or ''Jormungand''  (Abbot et al. 2011 ) state with incomplete ice cover will be discussed in the conclusions.

Theoretical considerations
In this section, we will consider what the appropriate boundary conditions for a snowball Earth ocean are and infer constraints for the expected circulation. The inferences will be tested in idealized process-oriented simulations in section 3.

a. Boundary conditions and ocean heat transport
Assuming that the ocean was entirely covered by sea ice, the heat budget of the global ocean would most likely be dominated by a balance between geothermal heating at the seafloor and heat loss through the ice sheet (see sketch in Fig.  1 ). Given a rough estimate for the atmospheric temperature above the ice sheet, and for the thermal conductivity of the ice, the required heat flux provides a first guess for the average thickness of the ice sheet in equilibrium. The mean thickness of the ice sheet can be estimated as h i ' k i DTQ 21 g , where Q g is the geothermal heating rate, DT is the temperature contrast across the ice sheet, and k is the thermal conductivity  (Pierrehumbert et al. 2011) . The term DT is to first order controlled by the atmospheric temperature, since the ocean temperature at the bottom of the ice sheet is expected to be near the freezing point. The geothermal heating rate during the Cryogenian is uncertain, but it was likely within about 30% of today's value of Q g ' 0.1 W m 22  (Korenaga 2008; Arevalo et al. 2009; Pollack et al. 1993) . Assuming further a temperature contrast across the ice sheet of DT ' 508C  (Pierrehumbert 2005)  and k i ' 2 W m 21 K 21  (Pierrehumbert et al. 2011) , we obtain h i ' 1 km. Spatial variations in the atmospheric temperature or the geothermal heat flux would lead to strong variations in the local equilibrium ice thickness. However, previous studies have shown that ice flow is relatively effective at homogenizing the thickness of the ice sheet, such that typical global-scale variations in the ice sheet thickness were likely only on the order of 10% (e.g.,  Ashkenazy et al. 2013 ). In the limit that variations in the ice thickness are relatively small, the spatial structure of the heat flux through the ice sheet is controlled primarily by the spatial structure of the atmospheric temperature and can be estimated as Q i ' k i h i DT , (1) where h i is the mean ice thickness. Equation (  1 ) provides a useful approximation as long as relative variations in the ice thickness are small compared to relative variations in DT. Relative variations in DT are O(1) (e.g.,  Pierrehumbert 2005; Abbot et al. 2013) , and thus significantly larger than the O(10%) variations in ice thickness found by  Ashkenazy et al. (2013) . However, significant uncertainty remains as to how effectively ice flow homogenizes the ice thickness, with less efficient ice flow possibly reducing spatial variations in heat flux through the ice sheet. Equation (  1 ) together with an estimate for the spatial structure of Q g can be used to estimate the required meridional ocean heat transport as a function of latitude F y (f) 5 ð 2p 0 ð p f (Q i 2 Q g )a 2 cosf dl df , ( 2 ) where f denotes latitude, l is longitude, and a is the radius of Earth. Given the atmospheric temperature and geothermal heat flux, Eq. (  2 ), together with Eq. (  1 ), provides a first-order estimate of the ocean heat transport, without requiring any understanding of the underlying ocean dynamics (see sketch in Fig.  1 ). Figure  2  shows an estimate of the meridional ocean heat transport as a function of latitude, computed under the simplifying assumption of a globally constant geothermal heat flux and ice sheet thickness. The term DT (which to good approximation is given by the difference between the freezing point and the atmospheric temperature above the ice sheet) is assumed to vary between 30 and 70 K between the equator and the pole  (Pierrehumbert 2005; Abbot et al. 2013) , and the geothermal heating rate is assumed constant at 0.1 W m 22 . The meridional heat transport peaks at about 2.5 TW at midlatitudes, which is almost three orders of magnitude smaller than the present-day poleward ocean heat transport  (Trenberth and Caron 2001 ) and also about three orders of magnitude smaller than the expected atmospheric heat transport in a snowball Earth climate  (Pierrehumbert 2005) . However, dividing the total meridional heat transport by the circumference of the planet and an average ocean depth of about 2 km nevertheless yields a meridional heat transport per crosssection area that peaks at about 45 W m 22 (Fig.  2c ). Comparing this to the average vertical heat flux of about 0.1 W m 22 suggests that over most of the ocean the horizontal component of the heat transport was larger than the vertical heat transport by more than a factor of 100. This has important implications for the expected dynamics, as will be discussed below. The surface temperatures assumed for Fig.  2  are estimates for an early snowball stage, when CO 2 concentration was low. Near the termination of a snowball event, the tropical atmospheric temperatures must have increased to around the freezing point (e.g.,  Abbot et al. 2012 Abbot et al. , 2013)) . Since it is the relative variation in DT that effectively governs the meridional heat transport, an overall warmer surface temperature (i.e., smaller mean DT) with similar meridional gradient, would have led to an increased meridional heat transport. If the FIG.  1 . Sketch of the snowball Earth ocean. The ocean is heated from below by geothermal heating Q g , which is balanced by a similar heat loss through the ice sheet Q i . A meridional gradient in the atmospheric temperature T atm implies a meridional gradient in the temperature contrast across the ice sheet DT, which in turn leads to a meridional gradient in the heat flux through the ice sheet Q i . A poleward and upward meridional ocean heat transport is required to balance the heat fluxes through the boundaries (wavy arrows). In the absence of salt, the heat flux by geostrophic eddies is directed along isotherms (dotted lines). More generally the buoyancy transport is directed along isopycnals. Freezing and melting is expected to enhance the horizontal buoyancy transport and therefore flatten the isopycnal slopes (see text). atmospheric temperature in the tropics is assumed to be near the freezing point, the heat transport increases by about a factor of 4 compared to the values shown in Fig.  2 . Finally, the geothermal heat flux was likely enhanced at low latitudes, associated with the existence of a diverging low-latitude supercontinent  (Li et al. 2008) . This could have further contributed to increase the poleward ocean heat transport, though the order of magnitude would likely be unaffected. Before proceeding, it should be noted that some of the meridional heat transport may be accomplished not by a transport of sensible heat but by a freshwater transport, balancing freezing and melting at the bottom of the ice sheet. Given the salinity difference between the ice sheet and seawater, and the latent heat of freezing, this freshwater transport can be translated into an effective latent heat transport. We will return to this issue below.

b. Energetics
Using the Boussinesq approximation, the mechanical energy input associated with geothermal heating and heat loss through the ice sheet can be expressed in terms of the potential energy gain: _ P 5 2 ð _ bz dV ' H ð gar 21 c 21 p Q g dA, (3) where _ b is the buoyancy tendency, H is the depth of the ocean, g is the gravitational acceleration, a is the thermal expansion coefficient, c p is the heat capacity, and r is the density of seawater. The first integral in Eq. (  3 ) is taken over the entire volume of the ocean, while the second integral is taken over the bottom of the ocean. The second step assumes that the total buoyancy flux through the bottom, associated with geothermal heating, equals the total buoyancy flux at the top and that there are no sources or sinks of buoyancy in the interior. Because of the nonlinearity of the equation of state, this is not strictly true. While heat and salt are conserved variables, buoyancy is not strictly conserved. However, for the present purposes of obtaining a rough scaling for the mechanical energy input, we will ignore the nonlinearity in the equation of state and treat buoyancy as a conserved variable. It may seem surprising that the energy input does not depend on melting and freezing at the bottom of the ice sheet, which leads to buoyancy fluxes via latent heat transfer and brine rejection. However, if the bottom of the ice sheet is relatively flat, all freezing and melting happens at about the same depth and thus does not contribute to the mechanical energy budget  (Sandström 1908; Paparella and Young 2002) . To the extent that there are differences in the ice thickness, ice is generally expected to be thinner at low latitudes, where melting dominates, while it is thicker at high latitudes, where freezing dominates (e.g.,  Ashkenazy et al. 2014) . Melting, which leads a net buoyancy gain (see below), thus would occur at higher levels than freezing, which leads to a net buoyancy loss. This configuration, again, is not effective at driving a circulation  (Sandström 1908; Paparella and Young 2002) . To make inferences about the ocean circulation, we need to understand how the potential energy input in Eq. (  3 ) is converted into kinetic energy before eventually being dissipated. As previously noted by  Ashkenazy and Tziperman (2016) , the situation has some similarity to Earth's atmosphere (much more so than to the present-day ocean), which is predominantly heated radiatively near the surface and at lower latitudes and cooled at higher altitudes and higher latitudes. Part of the potential energy input in Earth's atmosphere is released via convection (mostly in the tropics), but much of it is tapped into by baroclinic instability, which drives a turbulent, largely geostrophic circulation (e.g., FIG.  2 . Estimate of the ocean heat transport as a function of latitude for a given atmospheric temperature distribution and assuming a globally constant geothermal heating rate of 0.1 W m 22 . (a) The assumed temperature contrast across the ice sheet. (b) The total poleward heat transport, according to Eq. (  2 ). (c) The mean poleward heat transport per unit area cross section, computed as the total heat transport divided by the ocean depth and circumference of Earth at the respective latitude.  Stone 1972; Jansen and Ferrari 2013) . Whether or not the heat transport is dominated by geostrophic turbulence, as opposed to convection or symmetric instability, depends on the geostrophic Richardson number Ri 5 f 2 › z bj=bj 22 , where f is the Coriolis parameter. If Ri 1, the dynamics are expected to be dominated by baroclinic instability driving geostrophic turbulence (e.g.,  Boccaletti et al. 2007; Fox-Kemper et al. 2008) . Before proceeding to explicitly estimate a characteristic Richardson number for the snowball Earth ocean, we want to continue our analysis of energetics, assuming that the potential energy provided by geothermal heating is indeed converted into geostrophic turbulence. The implicit assumption that Ri 1 will be justified a posteriori in section 2c. Because of the lack of a forward energy cascade  (Charney 1971; Salmon 1978 Salmon , 1980;; Rhines 1979 ), geostrophic eddies are understood to lose most of their energy via a transfer of energy into internal waves and three-dimensional turbulence near the bottom boundary (e.g.,  Ledwell et al. 2000; Nikurashin et al. 2013) . Frictional dissipation in the bottom boundary layer is typically parameterized using a quadratic bottom drag, which follows directly from dimensional considerations  (Gill 1982; Willebrand et al. 2001; Arbic and Scott 2008) . Assuming such a quadratic drag law, the frictional dissipation can be related to the geostrophic velocity V via a nondimensional drag parameter C D : _ E 5 2 ð C D jVj 3 dA. ( 4 ) Assuming a balance between this frictional dissipation in the bottom boundary layer foot_1  and the potential energy input provided by geothermal heating [Eq. (  3 )], we obtain an estimate for the characteristic eddy velocity as jVj ' (C 21 D r 21 c 21 p HgaQ g ) 1/3 . ( 5 ) Assuming a drag coefficient of C D ' 3 3 10 23  (Özgökmen and Fischer 2008) , c p ' 4000 J kg 21 K 21 , r ' 10 3 kg m 23 , H ' 2000 m, g ' 10 m s 22 , Q g ' 0.1 W m 22 , and a ' 10 24 K 21 (estimated for seawater at temperatures near the freezing point), we obtain jVj ' 2.5 cm s 21 . Equation (  5 ) technically provides an estimate only for the geostrophic velocity near the bottom boundary. However, since the frictional halting scale for the turbulent cascade is expected to be much larger than the deformation radius in a snowball Earth ocean (as will be shown below), we expect the kinetic energy to be approximately barotropic, such that Eq. (  5 ) provides a useful estimate for the characteristic eddy velocity over the entire water column  (Jansen et al. 2015) . Equation (  4 ) further considers only the kinetic energy dissipation in the turbulent bottom boundary layer, but additional routes to dissipation of geostrophic kinetic energy have been proposed [see  Wunsch and Ferrari (2004)  and  Ferrari and Wunsch (2009)  for a review], and there are significant uncertainties with regards to the adequate drag coefficient C D . Moreover, tidal flows can add a background velocity that enhances energy dissipation. However, even if only 10% of the total kinetic energy dissipation is given by a quadratic drag in the form of Eq. (  4 ), the characteristic eddy velocity estimate would still yield about 1.2 cm s 21 . We can thus conclude with some confidence that eddy velocities were likely on the order of a centimeter per second. c. Eddy mixing rates and the impact on the oceanic gradients of temperature and salinity Given an estimate for the eddy mixing length L mix , the eddy velocity can be used to obtain an estimate for the eddy diffusivity: K ; V 3 L mix . We may expect the mixing length to be given by the smaller of the Rhines scale L R ; jVj 1/2 b 21/2  (Rhines 1979) , where b is the planetary vorticity gradient, and a frictional halting scale L f ; HC 21 D  (Grianik et al. 2004) . With b ; O(10 211 ) m 21 s 21 and jVj ; O(0.01) m s 21 , we find L R ; O(10-100) km. With H ; O(1) km and C D ; O(10 23 ), we instead find L f ; O(1000) km. This suggests that the mixing length is likely limited by the Rhines scale. 2 A quantitative estimate for the eddy diffusivity, when the mixing length is limited by the Rhines scale, is provided by  Jansen et al. (2015)  as K ' 0:25jVj 3/2 b 21/2 . ( 6 ) Using a midlatitude value for the planetary vorticity gradient (b ' 1.6 3 10 211 m 21 s 21 ) and assuming an eddy velocity in the range of 1-3 cm s 21 , we obtain an estimated range for the eddy diffusivity of around 60 to 300 m 2 s 21 . This is somewhat smaller than eddy diffusivities observed in the present-day ocean, but the difference is likely to be less than one order of magnitude (e.g.,  Tulloch et al. 2014) . The estimated eddy diffusivity is also somewhat lower than the estimate provided by  Ashkenazy and Tziperman (2016) . Wind-driven gyres are expected to be absent in a snowball Earth ocean, which is covered by a thick ice sheet, and  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  argue that a significant meridional overturning circulation can only be maintained in the immediate vicinity of the equator. The meridional heat transport in the extratropics is therefore likely dominated by turbulent eddies. The eddy diffusivity estimate, together with the meridional heat flux estimate in Eq. (  2 ), can then used to obtain an estimate for the meridional temperature gradient. Matters are complicated by the possibility for ice melting and freezing, which allows for part of the meridional heat transport to be accomplished by freshwater transport. Before considering freezing and melting, we simplify the problem by assuming that all meridional heat transport is in the form of sensible heat. The meridional heat transport in Eq. (  2 ) can then be combined with the eddy diffusivity to directly obtain an estimate for the meridional temperature gradient as › y T 5 F y H 21 L 21 r 21 c 21 p K 21 , where F y is the meridional heat flux estimated in Eq. (  2 ), H is the depth, and L is the zonal extent of the ocean. The argument in section 2a suggested that F y H 21 L 21 is O(10) W m 22 , while the eddy diffusivity K is O(100) m 2 s 21 . This yields a meridional temperature gradient on the order of 10 24 K km 21 or 0.1 K over 1000 km. Compared to the present-day ocean, temperature thus would have been very homogeneous. We can also infer an estimate for the vertical stratification by noting that in the adiabatic interior of the ocean, geostrophic eddies transport buoyancy primarily along isopycnals (e.g.,  Plumb and Ferrari 2005) . If both the horizontal and vertical flux of buoyancy are dominated by sensible heat flux, the slope of the isopycnals then is given directly by the ratio of the vertical to the horizontal heat transport, which in section 2a was argued to be on the order of 1/100 (see also Fig.  1 ). The thermal stratification thus would be larger by a factor of O(100) than the horizontal temperature gradient, that is, on the order of 0.01 K km 21 . With a thermal expansion coefficient, a ' 10 24 and g ' 10 m s 22 , this yields a buoyancy frequency of order N 5 (ag› z T) 1/2 5 O(10 24 ) s 21 and a deformation radius on the order of NHf 21 5 O(1) km. The above results for the meridional temperature gradient and stratification hold only under the assumptions that we can neglect freezing and melting and that temperature is the only variable controlling buoyancy variations, which is not likely to hold in reality. Instead, melting at low latitudes and freezing at high latitudes will likely cause part of the meridional heat transport to be in the form of latent heat of freshwater. Because freshwater fluxes associated with freezing and melting have an effect on buoyancy that is about a factor of 5 larger than that of the associated latent heat transfer, foot_3  the effect would be a significant increase in the meridional buoyancy transport. Since the vertical buoyancy flux is unaffected, the ratio of meridional to vertical buoyancy transport would be increased. Using again that the eddy buoyancy transport is directed along isopycnals, we thus find a weaker isopycnal slope than what was estimated above. In the limit that all meridional heat transport is accomplished via a freshwater flux, the isopycnal slope would be reduced by about a factor of 5. The increased meridional buoyancy flux would further imply a similarly increased meridional buoyancy gradient (realized via a salinity gradient). The increase in horizontal buoyancy gradient and reduction in isopycnal slope would finally imply an increased stratification by up to about a factor of 25 and thus an increased deformation radius by up to about a factor of 5. In summary, we find that meridional temperature and salinity gradients were very weak compared to the present-day ocean. However, as in today's ocean, isopycnal slopes were very small in an absolute sense: on the order of 1/100 to 1/1000, indicating that the stratification, although weak, was robustly stable. The deformation radius was likely in the range of about 1-5 km. The arguments above relied on the assumption that the dynamics are dominated by geostrophic eddies as opposed to upright or slantwise convection. This assumption is justified if geostrophic turbulence is able to maintain a mean state with Richardson numbers much larger than one. Using the definitions of isopycnal slope s [ j=bj/› z b and deformation radius L d [ (› z b) 1/2 Hf 21 , we can express the Richardson number as Ri 5 s 22 (H/L d ) 2 . From the above considerations we find that H/L d 5 O(1), while s 1 and thus indeed Ri 1.

Numerical simulations
This section discusses numerical simulations to test the theoretical arguments presented above. As discussed above, we anticipate a deformation radius in the range of 1-5 km, which suggests that a horizontal resolution around 1 km or finer is required to resolve only the deepest modes of baroclinic instability. Globalscale, eddy-resolving simulations are thus computationally prohibitive. Instead, idealized numerical simulations are performed in a smaller domain but are subject to similar boundary conditions. Specifically, the fluid is heated from below by a weak geothermal heat flux, while losing heat through a thick ice sheet at the top. Meridional inhomogeneities in the geothermal heat flux and heat loss through the ice sheet give rise to a meridional heat transport as described by Eq. (  2 ). For illustrative purposes, we will first consider an idealized fluid with a linear equation of state, where density depends only on temperature, and phase changes are omitted. We will then proceed to the more realistic case where freezing and melting at the bottom of the ice sheet modifies the heat and freshwater budget, and fluid densities are computed using a realistic equation of state. Eventually, it will be shown that most of the basic results can be reproduced with a noneddying model, where along-isopycnal eddy fluxes are parameterized using a Gent-McWilliams skew flux  (Griffies 1998 ) with an eddy diffusivity of 150 m 2 s 21 , as predicted in section 2b.

a. Model description
The simulations use the Massachusetts Institute of Technology General Circulation Model (MITgcm;  Marshall et al. 1997) , employing the hydrostatic and Boussinesq approximations. Preliminary simulations showed negligible differences between hydrostatic and nonhydrostatic configurations, and non-Boussinesq effects are very unlikely to be relevant because of the very small variations in density. The domain is 1600 km long in the meridional and 160 km wide in the zonal direction. The horizontal boundary conditions are periodic in the zonal direction, and no-slip walls are imposed at the southern and northern end of the domain. The Coriolis parameter is f 5 10 24 s 21 in the center of the domain and varies linearly in the meridional, with a planetary vorticity gradient b [ › y f 5 1.6 3 10 24 s 21 m 21 . The depth of the ocean is 2 km, with an additional 1-km ice sheet in the simulations with explicit treatment of freezing and melting. Unless otherwise mentioned, the eddypermitting simulations use a horizontal grid spacing of 1 km, while the noneddying simulations use a grid spacing of 20 km. The simulations without ice use 20 unevenly spaced vertical levels, with a resolution ranging from 50 m near the top and bottom boundaries to 150 m in the interior. The simulations with explicit treatment of freezing and melting use 23 subice levels with the resolution refined to 10 m under the ice sheet. Heat fluxes through the bottom and through the ice sheet are prescribed and vary in latitude, as described below. Importantly, the net prescribed heat flux through the bottom of the ocean, integrated over the entire domain, always equals the net prescribed heat flux through the top of the ice sheet, as necessary to obtain a quasiequilibrium state. Simulations with explicit treatment of ice use the MITgcm shelf ice package  (Losch 2008) , which describes ocean-ice sheet interactions following the three-equation thermodynamics of  Hellmer and Olbers (1989)  with the modifications of  Jenkins et al. (2001) . Frictional dissipation in the bottom boundary layer is parameterized using a quadratic bottom drag law with a nondimensional drag parameter C D 5 3 3 10 23 (e.g.,  Arbic and Scott 2008) . Free-slip conditions are applied at the upper boundary. Enstrophy is dissipated using a biharmonic hyperviscosity, which in the eddy-permitting simulations is formulated following  Leith (1996)  and  Fox-Kemper and Menemenlis (2008) . Large uncertainty exists with regards to the appropriate vertical diffusivity of heat and salt for a snowball Earth ocean [see discussion in  Ashkenazy and Tziperman (2016) ]. Unless otherwise noted, the simulations discussed below use a vertical diffusivity of k 5 10 24 m 2 s 21 , which is somewhat larger than values typically found in the present-day ocean  (Ledwell et al. 2011) . The sensitivity of the results to the vertical diffusivity will be discussed. Convection is parameterized by a large vertical diffusion whenever the column is statically unstable. For present-day ocean simulations, the convective diffusivity is typically chosen on the order of 10 m 2 s 21 . This value is consistent with the velocity and length scales expected in rotating convection subject to a surface cooling on the order of 100 W m 22 , as experienced in the present-day high-latitude ocean  (Jones and Marshall 1993) . However, typical buoyancy fluxes in the snowball Earth ocean were about three orders of magnitude smaller. The results of  Jones and Marshall (1993)  suggest that both length and velocity scales in rotating convection are proportional to the square root of the buoyancy flux, which suggests a convective diffusivity proportional to the buoyancy flux. Consistent with the reduced buoyancy fluxes, the simulations thus employ a convective diffusivity of k conv 5 10 22 m 2 s 21 . To test the sensitivity of the simulations to this uncertain parameter, an additional simulation was performed in which the convective diffusivity was increased by two orders of magnitude to k conv 5 1 m 2 s 21 . The results indicate little sensitivity to the choice of the convective diffusivity, consistent with the result that eddies maintain a stable stratification and convection only plays a role in close vicinity to the boundaries.

b. Idealized simulations without phase changes
To gain insight into the underlying physical processes (as well as for computational reasons), it is beneficial to start with idealized numerical simulations that do not consider the effect of freezing and melting at the bottom of the ice sheet. The simulations use a linear equation of state where buoyancy is related only to temperature: b [ 2g r 2 r 0 r 0 5 ga(T 2 T 0 ) , (7) where g 5 9.81 m s 22 is the gravitational acceleration, and a 5 10 24 K 21 is the thermal expansion coefficient. The terms r 0 and T 0 are arbitrary reference densities and temperatures. The simulations are forced by a heat flux through the bottom and top boundaries, which varies in the meridional direction as Q bot 5 0:1 W m 22 2 D Q sin(py/L) 3 and Q top 5 0:1 W m 22 1 D Q sin(py/L) 3 , ( 8 ) where y goes from 2L/2 at the southern boundary to L/2 at the northern boundary. For symmetry, similar (but opposite signed) forcing gradients are applied at the top and bottom boundaries. Relaxing this symmetry constraint does not alter the results significantly. Simulations with two different values for the meridional forcing gradient will be discussed: D Q 5 0.05 W m 22 and D Q 5 0.1 W m 22 . In the simulation with D Q 5 0.1 W m 22 , the relative variations in buoyancy fluxes are likely larger than actual variations during snowball Earth events. However, as discussed in section 2, more relevant for the dynamics are the net vertical and horizontal heat fluxes per unit area. Because of the smaller meridional extent of the domain, larger variations in the heat fluxes through the boundaries are necessary to obtain horizontal heat fluxes of similar order as expected for the snowball Earth ocean. The implied meridional heat flux per cross-section area is shown for the two cases in Fig.  3 . In both simulations the meridional heat flux per crosssection area is larger than the vertical heat flux by more than a factor of 100 and of similar order (albeit somewhat smaller) than the meridional heat transport estimated for the snowball Earth ocean (cf. to Fig.  2c ). Because of the effect of the meridional heat transport on stratification (see section 2c), the deformation radius in the simulation with D Q 5 0.05 W m 22 is smaller than in the simulation with D Q 5 0.1 W m 22 . To allow for an adequately eddy-permitting resolution in both simulations, the horizontal grid spacing in the simulation with D Q 5 0.05 W m 22 is reduced to 500 m. Figure  4  shows snapshots of temperature and flow speed at a depth of 700 m and over the central 800 km of the domain, after a statistically steady state has been reached (which here takes about 100 yr). In both cases we see a turbulent flow, with eddies stirring up a largescale meridional temperature gradient. The temperature gradient in the simulation with D Q 5 0.1 W m 22 is around 5 3 10 25 K km 21 , which is on the same order as the estimate of O(10 24 ) K km 21 given in section 2. The temperature gradient in the simulation with D Q 5 0.05 W m 22 is somewhat weaker, which is in qualitative agreement with the expected effect of a reduced forcing gradient. The characteristic eddy velocity is on the order of a few centimeters per second, with a root-mean-square (rms) velocity of 1.8 cm s 21 in both simulations, in agreement with the prediction in section 2 [and simulations in  Ashkenazy and Tziperman (2016) ].  4  The characteristic eddy size appears to be somewhat reduced in the simulation with D Q 5 0.05 W m 22 as compared to the simulation with D Q 5 0.1 W m 22 . This is likely a result of the reduced deformation radius in the simulation with D Q 5 0.05 W m 22 . Notice, however, that eddies in both simulations are larger than the deformation radius, which is indicative of a significant turbulent inverse Figure  5  shows the time-and zonal-mean temperature field in the simulations. Black lines indicate the direction of the bulk heat transport, computed by linearly connecting enclosed regions of identical integrated heat flux through the top and bottom boundaries. The thermal structure shows that the water column is stably stratified away from the boundaries, with the slope of the isotherms roughly predicted by the direction of the heat transport. Neutral to weakly unstable stratification is found near the top and bottom boundaries. Near the boundaries, geostrophic eddies become inefficient at transporting heat in the vertical and convection takes over. The thickness of these convective boundary layers is likely overestimated in the present simulations because of the limited horizontal resolution, which allows only the deepest vertical modes to be resolved. The presence of higher baroclinic modes (which have smaller deformation radii and thus require finer resolution to be resolved) may allow geostrophic eddies to efficiently transport heat much closer to the top and bottom boundaries, thus stabilizing the stratification (e.g.,  Ferrari et al. 2010) . The resolution in the simulations discussed above is best characterized as ''eddy permitting,'' that is, the resolution is sufficient to allow for the development of geostrophic turbulence from baroclinic instability, but biases due to the relatively coarse resolution are expected. We can estimate the baroclinic deformation radius as L d [ f 21 ð N dz, (9) where N [ › z hbi 1/2 is the buoyancy frequency, foot_7  with h i denoting a horizontal average across the domain. For the simulation with D Q 5 0.1 W m 22 , we find L d ' 1.5 km, while for the simulation with D Q 5 0.1 W m 22 , L d ' 1 km. The wavelength of the fastest growing linearly unstable mode is generally a few times L d , about 3.9 3 L d for the Eady model, which represents a reasonable approximation to the situation here (e.g.,  Vallis 2006) . This suggests that the fastest growing wave is resolved with about six grid points in the simulation with D Q 5 0.1 W m 22 and about eight grid points for the simulation with D Q 5 0.05 W m 22 . The main effect of insufficient resolution is expected to be a significant spurious dissipation of EKE by explicit or numerical viscosity near the grid scale  (Jansen and Held 2014) . This is confirmed by analysis of the energy budget, which suggests that about 50% of the kinetic energy is lost to (explicit or numerical) viscous dissipation. Considering that the energy dissipation by bottom friction (which would have to come up for the additional dissipation otherwise) is cubic in the flow velocity [Eq. (  4 )], this spurious viscous energy dissipation is expected to lead to an underestimate of the characteristic eddy velocity by about 25%. The simulations discussed above use a zonally reentrant domain, even though a supercontinent during snowball Earth time periods would have provided a zonal barrier at least at low latitudes (see also  Ashkenazy et al. 2013 Ashkenazy et al. , 2014)) . To analyze the effect of a zonal barrier, an additional simulation was performed in a closed basin. The setup is identical to the simulation with D Q 5 0.1 W m 22 described above, but with no normal flow, no-slip boundary conditions along the eastern and western boundaries of the domain. While a weak meridional overturning circulation develops in this simulation, the meridional temperature gradient, stratification, and rms velocity all remain within 20% of the results obtained without a continental boundary (not shown). This result suggests that the presence of continental boundaries, which may support a large-scale mean circulation, is not likely to change the results qualitatively, as also found by  Ashkenazy et al. (2013) . However, various factors, such as domain size and geometry or spatially inhomogeneous geothermal heating, could substantially impact the large-scale circulation. The potential role of large-scale circulation in a snowball Earth ocean thus remains an interesting topic for future work.

c. The role of freezing and melting
As discussed in section 2, freshwater exchange associated with freezing and melting at the bottom of the ice sheet affects the buoyancy fluxes at the upper boundary. To analyze the effects on the flow field and mean state, and to test the predictions of section 2, this section discusses a simulation in which the ocean interacts with an ice sheet of fixed thickness H ice 5 1 km. The simulation uses a realistic seawater equation of state, following  Jackett and McDougall (1995) . The heat flux through the ice sheet and the geothermal heating rate are specified as before, with D Q 5 0.1 W m 22 . Notice that the heat flux boundary condition prescribes the conductive heat flux through the ice sheet (which amounts to prescribing the vertical temperature contrast between the atmosphere and ocean), but the sensible heat flux in and out of the ocean can be modified by freezing and melting. To achieve a quasi-equilibrium solution in a manageable amount of time, the initial conditions were chosen such that the ocean water is near the freezing point. For the chosen initial salinity of 50 g kg 21 (as in  Ashkenazy et al. 2014) , the freezing point at the bottom of the ice sheet is just below 23.68C. The simulation nevertheless requires a much longer integration time to reach a quasi-equilibrium state than simulations without ocean-ice interactions. An initial spinup simulation was therefore performed at a much coarser horizontal resolution of 20 km, using the skew flux parameterization for eddy fluxes discussed below. The equilibrated zonalmean state of this coarse-resolution simulation was then used as an initial condition for a simulation at 1-km resolution, which was integrated to a statistical equilibrium for another 260 yr. Statistics were computed from the last 10 yr of the high-resolution simulation. Figure  6  shows snapshots of temperature, salinity, and velocity after a statistical equilibrium has been reached. As in the simulations without an explicit ice sheet, a turbulent flow develops, which maintains a large-scale temperature gradient of around 5 3 10 25 K km 21 . Freezing and melting further leads to a large-scale gradient in salinity of around 5 3 10 26 g kg 21 km 21 . The thermal expansion coefficient here is on the order of 10 24 K 21 , while the haline contraction coefficient is on the order of 10 23 kg g 21 . The effects of temperature and salinity on the large-scale buoyancy gradients are thus of similar order in this simulation, with both contributing to a poleward increase in density. Figure  6c  reveals characteristic eddy velocities on the order of a few centimeters per second, with an rms velocity of 2 cm s 21 , again similar to the results obtained without an explicit ice sheet. A similar characteristic eddy velocity scale was predicted from the theoretical considerations in section 2 because ocean-ice sheet interactions do not affect the mechanical energy budget. Figure  7  shows time-and zonal-mean temperature, salinity, and potential density fields in the simulation. As before, eddies are able to maintain a statically stable stratification in the fluid interior, which now is realized through a combination of temperature and salinity effects. The net density stratification is increased, leading to an average deformation radius of about L d ' 4 km. Convectively neutral boundary layers again develop near the top and bottom boundaries, except near the southern end of the domain, where a statically stable freshwater lens develops near the upper boundary. The solid black lines in Fig.  7c  mark the direction of total (sensible plus latent) heat transport, estimated as before from the imposed heat flux boundary conditions. The slope of the density (and thus buoyancy) surfaces is flatter than the direction of the heat transport, as expected because of the difference between the directions of the heat and buoyancy transports (see section 2). The direction of buoyancy transport can be computed from the net buoyancy exchange at the bottom and top boundaries, using the diagnosed rates of freezing and melting. The buoyancy flux at the bottom boundary is obtained directly from the heat flux as B bot 5 gaQ bot /(r 0 c p ), where a again is the thermal expansion coefficient and c p 5 3994 J kg 21 K 21 is the heat capacity. The buoyancy flux at the interface with the ice sheet can be estimated as B top 5 ga Qtop /(r 0 c p ) 2 gbF S/r 0 , ( 10 ) where Qtop is the (diagnosed) sensible heat flux and F is the freshwater flux at the ocean-ice interface (all fluxes are positive upward), S is the salinity of ocean water (the ice is assumed to be fresh in the model), and b is the haline contraction coefficient. The thermal expansion and (to a lesser extent) haline contraction coefficients vary with depth, primarily because of their dependence on pressure. As a result, buoyancy is not exactly conserved, even though temperature and salinity are. To avoid having to introduce interior sources and sinks of buoyancy, buoyancy fluxes are for diagnostic purposes approximated using constant average thermal expansion and haline contraction coefficients: a 5 1.1 3 10 24 K 21 and b 5 7.8 3 10 24 kg g 21 . The maximum error of this approximation is about 30%. The direction of the buoyancy flux can then be estimated by meridional integration of the buoyancy fluxes through the boundaries, analog to the computation of the heat flux direction. The dashed lines in Fig.  7c  show the estimated direction of the buoyancy flux, which aligns well with the isopycnal slope in the fluid interior.

d. Noneddying simulations
The results above suggest that turbulent eddies in a snowball Earth ocean share similar properties as geostrophic turbulence in the present-day atmosphere and ocean. In particular, potential energy is released by an upward flux of buoyancy along density surfaces, with little irreversible mixing across density surfaces. This behavior can be mimicked using a GM parameterization for the buoyancy fluxes, in combination with a  Redi (1982)  parameterization for mixing along isopycnals. We therefore here compare the results of the eddypermitting simulations to coarse-resolution, noneddying simulations, where eddy effects are parameterized using the GM skew flux formulation proposed by  Griffies (1998) , which combines the effects of  GM and Redi (1982) . With the isopycnal diffusivity and GM coefficient chosen identically (as is typical in ocean models), the meridional eddy fluxes of heat and salt are simply given by F C,y 5 2K› y C , ( 11 ) where C may be temperature, salinity, or any conservative passive tracer, and K is the eddy diffusivity. The expression for the vertical fluxes is slightly more involved and can be found in  Griffies (1998) . Importantly though, the net buoyancy flux is directed along isopycnals. Equation (  11 ) can be used to estimate the eddy diffusivity in our eddy-permitting simulations, which gives K ' 150 m 2 s 21 , in agreement with the theoretical prediction in section 2. To test the GM skew flux parameterization in the context of a turbulent snowball ocean, the simulation described in section 3c was repeated with a grid spacing of 20 km and parameterized eddy fluxes with K 5 150 m 2 s 21 . Figure  8  shows the equilibrated zonal-mean temperature, salinity, and potential density fields in the noneddying simulation, which shall be compared to the results of the eddy-permitting simulation in Fig.  7 . The basic characteristics of the mean state show good qualitative agreement, though we also note some differences. As in the eddy-permitting simulations, the parameterized eddy fluxes maintain a statically stable stratification in the fluid interior, realized through a combination of temperature and salinity effects. The bulk temperature and salinity gradients are on the same order as in the eddying simulations. The slope of the isopycnals is given by the direction of the buoyancy transport, which again follows a somewhat weaker slope than the imposed heat flux. Notice that the use of a GM parameterization here is crucial to reproduce the isopycnal slopes and associated stable stratification. A purely horizontal diffusion of heat and salt [as used in the noneddying simulations of  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014)) ] would instead lead to a statically unstable stratification, with vertical heat transport maintained by the convection scheme. One obvious difference between the coarseresolution results in Fig.  8  and the high-resolution results in Fig.  7  relates to the behavior of the solution near the top and bottom boundaries. While the highresolution simulations suggest convectively neutral boundary layers over much of the domain, the stratification in the coarse resolution simulation remains stable, with approximately constant isopycnal slopes all the way to the boundaries. The convective boundary layers in the eddy-permitting simulations are a result of vertical eddy fluxes becoming inefficient near the boundaries. The GM parameterization applied here instead assumes that eddy fluxes remain constant all the way to the boundary. A tapering of eddy fluxes near the boundaries could be achieved with a generalization of the GM parameterization, such as proposed by  Ferrari et al. (2010) . However, as discussed above, the extent of the stable boundary layers may be significantly overestimated in our ''high-resolution'' simulations because only the deepest-mode baroclinic eddies can be resolved. It therefore remains unclear how much tapering near the boundaries would actually be realistic. The relatively low computational cost of coarseresolution simulations allows us to test the sensitivity of our results to uncertain parameters, such as the diapycnal vertical diffusivity. Additional coarse-resolution simulations were performed with vertical diffusivities reduced and increased by one order of magnitude to k 5 10 25 m 2 s 21 and k 5 10 23 m 2 s 21 . The simulation with reduced vertical diffusivity shows a significant shallowing of the stable freshwater lens at low latitudes, but otherwise differences to the reference case are relatively small (not shown). Larger differences are found when the vertical diffusivity is increased to k 5 10 23 m 2 s 21 (Fig.  9 ). The meridional temperature gradient is reduced and the salinity gradient is increased, although both remain within about a factor of 2 of the reference simulations. The reason for the reduced temperature and enhanced salinity gradients appears to be associated with enhanced melting at low latitudes, aided by the removal of freshwater from the surface boundary layer by vertical diffusion. Arguably the most striking difference to the reference simulation, however, is an increased isopycnal slope, which no longer follows the direction of the net buoyancy flux. The reason for the increased isopycnal slope can be understood by noting that the large vertical diffusion now contributes significantly to vertical buoyancy flux. The vertical buoyancy flux associated with vertical diffusion is B 5 2k› z b. The vertical component of the along-isopycnal geostrophic eddy transport instead can be estimated as B 5 2sK› y b 5 Ks 2 › z b, where K is the geostrophic eddy diffusivity, and s is the isopycnal slope. Vertical diffusion thus becomes a first-order contributor to vertical buoyancy flux when k * Ks 2 . With K ' 150 m 2 s 21 and s ' 1/400, the threshold becomes k * 10 23 m 2 s 21 . The energy required for vertical mixing is probably provided mostly by tides, which were likely stronger in a snowball Earth ocean  (Wunsch 2016) . However, great uncertainty remains as to how much of the tidal energy can be converted into baroclinic modes and eventually into small-scale interior mixing. The question of what sets the vertical diffusivity in a snowball Earth ocean thus remains an important topic for future research.

Conclusions
Theoretical arguments and numerical process studies suggest that the potential energy input associated with geothermal heating at the seafloor and heat loss through the ice sheet drives a turbulent circulation in a snowball world. The release of potential energy is dominated by baroclinic instability, which drives geostrophic turbulence that transports buoyancy poleward and upward along surfaces of constant density, thereby maintaining a statically stable stratification. The kinetic energy level can be estimated from a balance between this release of potential energy and frictional dissipation in the bottom boundary layer. The resulting eddy velocities are on the order of 1 cm s 21 and are thus smaller but probably within one order of magnitude of the present-day ocean. Eddy diffusivities are on the order of 100 m 2 s 21 , which again is smaller but probably within one order of magnitude of the present-day ocean. Because of the weak forcing, gradients of temperature and salinity are much smaller than in the present-day ocean, with global-scale potential temperature variations likely on the order of 0.1 K. FIG.  8 . As in Fig.  7 , but for a coarse-resolution simulation where eddy fluxes are parameterized using a GM skew flux parameterization  (Griffies 1998) . The contour intervals are identical to Fig.  7 , but the ranges of the colorbars are allowed to vary. The weak temperature and salinity gradients and the significant turbulent flow predicted in this study are in general agreement with the results presented by  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  and  Ashkenazy and Tziperman (2016) . Possibly the most important addition is the result that geostrophic eddies are able to maintain a statically stable stratification and likely dominate the vertical heat transport. This has important implications for the energetics of the turbulent flow as well as for the parameterization of eddies in ocean models. While  Ashkenazy et al. (2013 Ashkenazy et al. ( , 2014) )  use horizontal diffusion in their noneddying models, the results of the present study support the use of a parameterization following  Gent and McWilliams (1990) , where buoyancy fluxes are directed upward along isopycnals. It remains uncertain whether the ocean was entirely frozen over during Earth's snowball events or whether open ocean existed in a small low-latitude region (e.g.,  Pierrehumbert et al. 2011) . While the arguments provided here assume a fully ice-covered ocean, they likely remain relevant for states with an ice-free region near the equator. The warmer atmosphere in the equatorial region (required to maintain an ice-free ocean) as well as an expected freshwater input associated with glacial ice import would likely lead to a relatively warm and fresh top layer in the ice-free region, whose depth is modulated by wind-driven Ekman pumping (e.g.,  Rose 2015) . The dynamics in the deep ocean and away from the equatorial region, however, would likely be affected relatively little by this stable region. Maybe most importantly, the use of a GM parameterization for turbulent eddy fluxes is expected to remain adequate for simulations of a Waterbelt climate. Finally, geothermal heating is expected to remain crucial for the dynamics in the deep ocean and thus should always be included in future simulations of a snowball ocean, whether or not ice coverage is assumed to be complete. The results presented here may also be of relevance to other planetary bodies, such as Europa, which are believed to have an ocean covered by a thick ice sheet (e.g.,  Soderlund et al. 2014, and references therein) . The arguments in section 2 provide a recipe that can be applied to predict the flow characteristics and mean state of any thermally driven ocean, given estimates for the geothermal heat flux and the spatial structure of heat escape through the ice sheet. The results here stress the importance of meridional inhomogeneity in the top and bottom boundary conditions, which can lead to baroclinic dynamics that differ fundamentally from the convective solutions presented by  Soderlund et al. (2014) .