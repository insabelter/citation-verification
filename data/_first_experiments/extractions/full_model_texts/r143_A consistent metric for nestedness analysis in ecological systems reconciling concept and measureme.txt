Nestedness has been widely reported for both metacommunities and networks of interacting species. Even though the concept of this ecological pattern has been well-defined, there are several metrics by which it can be quantified. We noted that current metrics do not correctly quantify two major properties of nestedness: (1) whether marginal totals (i.e. fills) differ among columns and/or among rows, and (2) whether the presences (1's) in less-filled columns and rows coincide, respectively, with those found in the more-filled columns and rows. We propose a new metric directly based on these properties and compare its behavior with that of the most used metrics, using a set of model matrices ranging from highly-nested to alternative structures in which no nestedness should be detected. We also used an empirical dataset to explore possible biases generated by the metrics as well as to evaluate correlations between metrics. We found that nestedness has been quantified by metrics that inappropriately detect this pattern, even for matrices in which there is no nestedness. In addition, the most used metrics are prone to type I statistical errors while our new metric has better statistical properties and consistently rejects a nested pattern for different types of random matrices. The analysis of the empirical data showed that two nestedness metrics, matrix temperature and the discrepancy measure, tend to overestimate the degrees of nestedness in metacommunities. We emphasize and discuss some implications of these biases for the theoretical understanding of the processes shaping species interaction networks and metacommunity structure.
Ecologists have long searched for patterns and processes related to species distribution among sites (e.g. islands, hosts, fragments, resource patches) and to interspecific interactions in communities. Nestedness is a particular ecological pattern widely reported for species occurrences in metacommunities  (Patterson and Atmar 1986 , Wright and Reeves 1992 , Cutler 1991 , 1994 , Wright et al. 1998 ) and species interaction networks  (Bascompte et al. 2003 , Dupont et al. 2003 , Ollerton et al. 2003 , 2007 , Guimara ˜es et al. 2006 , 2007a , Lewinsohn et al. 2006 , Burns 2007) . In metacommunities, nestedness is found when sites with lower species richness tend to harbor proper subsets of those species present in richer sites  (Darlington 1957, Atmar and Patterson 1993) . Differences in habitat features such as isolation, size, quality and nested habitats, or in species attributes such as area requirements, abundance and tolerance to abiotic factors are the major explanations for the emergence of nestedness in metacommunities  (Darlington 1957 , Atmar and Patterson 1993 , Andre ´n 1994 , Cutler 1991 , 1994 , Lomolino 1996 ,  Wright et al. 1998 , Hylander et al. 2005 , Higgins et al. 2006) . For networks of species interactions, nestedness occurs when specialist species tend to interact with proper subsets of the species that interact with more generalist species  (Bascompte et al. 2003 , Jordano et al. 2006) . The major hypotheses about the emergence of nestedness in interaction networks involve differences in abundance of interacting species  (Lewinsohn et al. 2006 ), higher extinction rates for specialists that interact with other specialists  (Ollerton et al. 2003)  or the convergence and complementarity of traits among a set of species  (Thompson 2005 , Guimara ˜es et al. 2006 , Santamarı ´a and Rodrı ´guez-Girone ´s 2007). Nestedness is usually represented and measured using binary data through presence-absence matrices. In order to avoid terminological misunderstandings, we use the common jargon related to the presenceÁabsence matrix representation instead of terms specifically related to metacommunities or interaction networks. Matrix properties and their ecological meaning for metacommunities and interaction networks are presented in Table  1 . Nestedness by itself is not a metric, but a concept originally applied to a metacommunity structure in which the species present in species-poor sites constitute proper subsets of those ones present at species-rich sites  (Darlington 1957) . Its concept has not been formally defined through mathematical relationships, but instead by means of verbal statements about the arrangement of species among communities (or interactions among species). Perhaps for this reason, although there is relative consensus on the meaning of nestedness, there are several distinct metrics by which it can be measured  (Patterson and Atmar 1986 , Wright and Reeves 1992 , Atmar and Patterson 1993 , Cutler 1991 , 1994 , Lomolino 1996 , Wright et al. 1998 , Brualdi and Sanderson 1999 , Cam et al. 2000 , Hausdorf and Hennig 2003) . To be consistent with the definition of nestedness, a given metric should quantify: (1) whether marginal totals (i.e. fills) among columns and/or among rows differ, and (2) whether the presences (i.e. 1's) in less-filled columns and rows overlap, respectively, with those found in the more-filled columns and rows. In this paper, we highlight some critical inconsistencies between current metrics used to quantify nestedness and the concept of the nested subset pattern. We propose a new metric that matches with the concept of nestedness and compare its behavior with that of other metrics through analysis of model matrices ranging from highly-nested structures to alternative structures in which no degree of nestedness should be detected. In addition, we perform a test to verify whether the new metric correctly detects randomness in non-nested matrices. Finally, we use an empirical dataset to evaluate whether three popular metrics over-or underestimate the degree of nestedness in real ecological systems.

Methods


Nestedness metrics
Currently, the most used metrics to quantify nestedness are: (1) T, the matrix temperature measure  (Atmar and Patterson 1993) ; (2) C, a standardized version of the N C metric  (Wright and Reeves 1992) ; and (3) d, the discrepancy measure proposed by  Brualdi and Sanderson (1999) . T has been the most used metric and quantifies whether the observed arrangement of 1's and 0's deviates from the arrangement given by an isocline that describes a  T N C d 0 0 0 0 1 1 1 0 0 1 1 0 0 0 1 1 1 1 1 1 0 1 0 1 1 0 0 0 0 1 1 1 0 0 1 1 0 0 0 C Figure 1 . Illustration of the way by which T, C and d1 rearrange 1's and 0's in original (superior) matrices to produce a new arrangement (inferior matrices) and/or perform their calculations. (A) arrangement of 1's and 0's given by the algorithm in NTC  (Atmar and Patterson 1995) . The dashed line represents the isocline of 'perfect order'. All 1's below the isocline and all 0's above it configure unexpected presences and absences, respectively, in relation to a perfectly nested matrix. (B) calculation algorithm of the metric Nc. Values below each column are given by all possible paired combinations between 1's within each column, i.e. marginal total)(marginal total Á 1)/2. The sum of these values is Nc. (C) a perfect nested matrix according to the discrepancy metric. The discrepancy value of the upper matrix is 2 because there are two 1's positions that should be reallocated within rows to produce the lower matrix. perfect nestedness benchmark (Fig.  1A ). Contributions of unexpected absences and presences in the upper-left and bottom-right sides, respectively, are weighted by their squared Euclidian distances from the isocline. Recently, Almeida-Neto et al. (  2007 ) clarified that T is not a measure of disorder, as some authors have pointed out, because random distributions of 1's tend to produce intermediate rather than maximal T-values. Further descriptions and details on this metric can be found in  Wright et al. (1998) ,  Greve and Chown (2006) , Rodrı ´guez-Girone ´s and Santamarı ´a (2006),  Ulrich (2006a)  and  Ulrich and Gotelli (2007a) . The metric C is a standardized version of N C , which was originally defined as 'the number of times that a species' presence at a site correctly predicts its presence at richer sites'  (Wright and Reeves 1992) . According to  Wright and Reeves's (1992)  definition, N C is also equal to the sum of the number of species shared across all unique pairs of sites. Following our matrix terminology (Table  1 ), N C is a count of the number of times in which 1's are correctly predicted by other 1's from equally-or more-filled rows of the same column. In Fig.  1B , for example, the cell located at row 5 and column 1 (a 51 01) is correctly predicted by cells a 41 0 a 21 0a 11 01, but not by a 31 00. For a given column j, the number of correct predictions varies between zero and m(m (1)/2, in which m is the number of 1's in a column. Consequently, column j 01 has 6 correct predictions, whereas column j 05 has no correct prediction. Therefore, unlike T, C is a metric developed to quantify nestedness exclusively between rows. The standardization of N C is defined as:

C0
NC ( EfNCg maxfNCg ( EfNCg ; (1) where E{N C } and max{N C } are the expected and the maximum value of N C , respectively. E{N C } is given by a mean value obtained through a set of randomized matrices produced according to the null model of equiprobable distribution of 1's (but see  Bloch et al. 2007  for other null models), and max{N C } is the value that N C would take if the matrix were perfectly nested (sensu  Atmar and Patterson 1993) . Since the expected N C value is based on a randomization procedure, values of C that are close to zero indicate that the number of correct predictions of 1's is virtually the same as that given by the selected null model. C computes negative values for matrices less-nested than expected by chance, whereas positive values indicate some degree of nestedness. Discrepancy (d) is the number of 1's that must be reallocated within rows or columns to produce a perfectlynested matrix  (Brualdi and Sanderson 1999) . In Fig.  1C , the '1' at cell a 15 01 can be reallocated, leading to a 15 00 and a 12 01, and the '1' at the cell a 34 01 can be reallocated, leading to a 34 00 and a 31 01. Thus, this matrix has d02. A first standardized version of this metric, similar to that for N C , was originally developed by  Brualdi and Sanderson (1999) . More recently,  Greve and Chown (2006)  proposed three additional standardizations for d, namely d0, d1 and d2. Here we used d1 (0 d/matrix fill) because there is evidence that this metric behaves more consistently  (Greve and Chown 2006) . Note that the N C , and d treat rows and columns differently. They are therefore not invariant to matrix transposition.

The new metric
Our nestedness metric is based on two simple properties: decreasing fill (or DF) and paired overlap (or PO). Let us assume that in a matrix with m rows and n columns, row i is located at an upper position from row j, and column k is located at a left position from column l. In addition, let MT be the marginal total (i.e. the sum of 1's) of any column or row. For any pair of rows i and j, DF ij will be equal to 100 if the MT j BMT i . Alternatively, DF ij will be equal to 0 if MT j ]MT i . Likewise, for any pair of columns k and l, DF kl will be 100 if MT l BMT k and will be equal to 0 if MT l ] MT k . For columns, paired overlap (PO kl ) is simply the percentage of 1's in a given column l that are located at identical row positions to those in a column k. For rows, PO ij is the percentage of 1's in a given row j that are located at identical column positions to the 1's observed in a row i. For any left-to-right column pair and, similarly, for any upto-down row pair, there is a degree of paired nestedness (N paired ) as follows: if DF paired 0 0; then N paired 00; if DF paired 0 100; then N paired 0PO; From the n(n (1)/2 and m(m (1)/2 paired degrees of nestedness for n columns and m rows, we can calculate a measure of nestedness among all columns (N col ) and among all rows (N row ) by simply averaging all paired values of columns and rows. Finally, the measure of nestedness for the whole matrix is given by: NODF0 P N paired n(n ( 1) 2 ' m(m ( 1) 2 ; (2) in which NODF is an acronym for nestedness metric based on overlap and decreasing fill. Figure  2  illustrates how the new matric performs. Two basic properties are required for a matrix to have the maximum degree of nestedness according to our metric: (1) complete overlap of 1's from right to left columns and from down to up rows, and (2) decreasing marginal totals between all pairs of columns and all pairs of rows. A matrix with these two properties has approximately 50% of fill and was termed by  Atmar and Patterson (1993)  a maximally informative nested structure. It is important to note, however, that if the aim is to quantify nestedness exclusively among columns or among rows, the unique requirement to perfect nestedness is a continuous decrease in the marginal totals from left to right (for columns) or from up to down (for rows). NODF has some important features that distinguish it from the precedents metrics. One of its most important features is that it calculates nestedness independently among rows and among columns, which allows evaluating nestedness only among sites (i.e. species composition) or only among species (i.e. species occupancy). Another important feature is its versatility to evaluate how nested is one or more columns (or rows) in relation to other ones. This can be easily accomplished including only the columns or rows of interest. For instance, to evaluate whether columns c2 to c5 have proper subsets of the elements present in column c1 in the Fig.  2 , we only need to calculate the mean paired nested between c1 and the other columns (NODF 053). The procedure to evaluate whether a given column is nested within a set of columns located at its left side is virtually the same. The column c1 in the Fig.  2  has NODF 085 in relation to the four columns located at its right side. These properties of our new metric can be used to examine individual contributions of each column (or row) to the general nested pattern. Finally, it is important to highlight that NODF was thought to be dependent on the arrangement of columns and rows to allow testing hypotheses on the causes of nestedness by ordering columns and rows according to any reasoned criteria instead of only by the marginal totals.

Consistency with the concept of nestedness
We evaluated the consistency of T, C, d1 and NODF with the usual concept of nestedness using model matrices. Given that values of C and NODF increase with nestedness, whereas values of T and d1 decrease with nestedness, we used NT 0100(T and Nd10(1 (d1)100. It does not   1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 0 1 0 0 1 1 1 1 1 1 0 1 0 0 1 1 1 1 1 1 0 1 0 0 1 1 0 1 1 1 0 1 0 0 1 1 0 1 1 0 0 0 0 1 1 1 0 1 1 0 0 0 0 1 1 1 0 1 1 1 0 1 0 1 1 1 1 0 1 1 0 1 0 1 1 1 1 0 1 1 0 1 0 1 1 1 0 0 1 1 0 1 0 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 1 0 1 1 0 1 0 1 1 1 1 0 1 1 0 1 0 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 1 0 0 1 0 1 1 0 0 0 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 0 1 1 1 0 0 1 1 0 0 0 1 1 1 0 0 1 1 0 0 0 1 1 1 0 0 1 1 0 0 0 1 1 1 0 0 0 1 1 1 1 1 1 0 1 0 1 1 c1 c2 c1 c3 c1 c4 c1 c5 c2 c3 c2 c4 c2 c5 c3 c4 c3 c5 c4 c5 N paired =0 N paired =67 N paired =50 N paired =100 N paired =67 N paired =50 N paired =0 N paired =100 N paired =100 N paired =100 r1 r2 r1 r3 r1 r4 r1 r5 r2 r3 r2 r4 r2 r5 r3 r4 r3 r5 r4 r5 N paired =67 N paired =67 N paired =50 N paired =50 N paired =0 N paired =100 N paired =100 N paired =50 N paired =50 N paired =0 N columns = 63 N rows = 53 NODF = 58 Figure  2 . Illustration of the way by which nestedness is quantified according to NODF. First, we calculated the paired nested degree for each pair of column and for each pair of row. Then, the total nestedness among columns was quantified as the average values for all pairs of columns. The total nestedness among rows follows the same procedure applied for columns. Finally, the degree of nestedness for the whole matrix is calculated as the sum of all values of paired nestedness divided by the total number of pairs (i.e. the sum of all combinations of pairs of column and pairs of rows). make sense to convert C to a percentage scale because this metric is null model dependent and does not have minimum and maximum absolute values as T, d1 and NODF. Even so, we multiplied C values by 100 to facilitate comparison with the other metrics. We assessed whether each metric quantified nestedness in four model matrices with some nested structure: (1) 'Random'; (2) 'Perfect nestedness among columns', in which all columns have distinct fills but some rows were identical; (3) 'Nested pattern minimally filled', in which there is only a fully filled column and a fully filled row; and (4) 'Nested pattern maximally filled', in which only the cell located in the bottom-right corner is not filled (Fig.  3 ). In addition, we used another four model matrices in which no degree of nestedness should be found (at least among columns), according to the definition of nestedness: (1) 'Checkerboarding', in which 1's have 0's in all diagonally neighboring cells; (2) 'Perfectly compartmented model', constituted here by three subsets; (3) 'Beta-diversity', a model in which there is no overlap between columns; and (4) 'Exclusive subsets', based on the ''anti-nestedness'' model proposed by  Poulin and Gue ´gan (2000) , in which there is decreasing fill among all column pairs (but see  Almeida-Neto et al. 2007) . For convenience and to allow illustration, we used matrices with 5 or 6 columns and 15 rows (Fig.  3 ). For the 'random' model, we used the mean level of nestedness based on 30 matrices to produce a representative value instead of a value for a given matrix. Because T, C and d1 are sensitive to matrix transposition, we performed all the calculations for the models depicted in Fig.  3  and for their transposed matrices.

Diagnostic tests
Ideally, a metric for nestedness should not be affected by matrix size or shape. Furthermore, although the quantifica-  tion of nestedness is intrinsically related to matrix fill, type I and type II errors rates should not be affected by matrix fill, shape or size. We evaluated whether NODF, NC, NT and Nd1 were related to matrix size, shape and fill by generating matrices in which occurrence probabilities per cell were drawn from a uniform random distribution (equivalent to the equiprobable row and column null model) and in which only the variable of interest (size, shape or fill) was allowed to vary. For matrix size, we used square matrices to compare the degree of nestedness for 100 random matrices for each one of the following numbers of cells: 25, 100, 400, 900, 1600 and 2500. To evaluate the relationship between matrix shape and degree of nestedness, we created 100 random matrices for each one of the following ratios of columns to rows: 30/30, 25/35, 20/40, 15/45, 10/50 and 5/55. For matrix size and shape, we used 600 matrices with approximately 50% of fill. Finally, we examined whether matrix fill was related to the degree of nestedness by generating 1000 matrices with 30 columns and rows with matrix fill ranging from 5 to 95%. In addition to inspection of the absolute values of nestedness we also calculated a standardized effect size (SES) as a Z-transformed score (Z 0 [x (m]/s) to compare the observed index to the distribution of simulated indices (x 0observed index value, m 0 mean, s 0standard deviation of the 100 index values from the simulated matrices). By using Z-scores we evaluated whether type I errors rates were affected by the three abovecited matrix properties. 1 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 To evaluate whether the new metric correctly identified null matrices as being random, we used a procedure similar to that recently employed by  Ulrich and Gotelli (2007a) . We created 200 matrices by sampling individuals randomly from a set in which population sizes of the 'species' were distributed according to a lognormal speciesÁrank order distribution: S0 S 0 e [(a(R(R 0 ) 2 ] (3) in which S is the number of species per log 2 (abundance class R), S 0 is the number of species in the modal class R 0 , and a is the shape-generating parameter. Individuals were randomly sampled, and column totals m i (i.e. species number per site) were held nearly constant (randomly taking m i , m i '1, or m i (1 species). For each matrix, the shape-generating parameter a was sampled from a uniform random distribution between 0.1 and 0.5 (a canonical lognormal distribution has a 00.2; May 1975). Total numbers of rows m and columns n per matrix were also sampled from uniform random distributions (3 5m 5200 and 35n 550). Matrices produced by this sampling protocol cannot be more nested than expected by chance because a large fraction of their columns have identical marginal totals. Statistical significance was assessed by the 95% confidence intervals produced by two null model algorithms that span the range of possibilities from very conservative to very liberal: FF (fixed rowÁfixed column) and EE (equiprobable row totals, equiprobable column totals). The FF algorithm preserves both the row and column totals in the original matrix  (Connor and Simberloff 1979, Gotelli 2000)  but randomizes the internal structure through a variation of the 'sequential swap algorithm'  (Manly 1995, Gotelli and Entsminger 2001) . When matrices are extremely nested or have nearly a checkerboard pattern, the fixed-fixed model will actually fail because there are too few or even no matrix re-arrangements possible that will simultaneously preserve row and column totals. The EE algorithm preserves the total number of species occurrences in the original matrix but allows both row and column totals to vary freely  (Gotelli 2000) . This algorithm retains the least of the original matrix structure and is prone to type I errors in nestedness analyses  (Wright et al. 1998 , Gotelli 2000 , Ulrich and Gotelli 2007a , 2007b) .

Nestedness in empirical matrices
In a third approach we evaluated the relationship between the four metrics using the empirical dataset compiled by  Atmar and Patterson (1995) . Only matrices with at least three columns and rows were used (n 0287 matrices). We performed the Wilcoxon signed rank test to compare the degree of nestedness calculated by NT, Nd1 and NODF. C was not included in this analysis because it is standardized through a null model and, consequently, can produce negative values. As NODF can be used to quantify nestedness only among columns and only among rows, we also evaluated: (1) whether more endemic species occupied a subset of the sites where more widespread species were found, and (2) whether species-poor sites had proper subsets of the species found in more species rich ones. This second metacommunity feature is what most nestedness metrics aim to quantify. However, T measures whether 1's are located at the upper-left side of a matrix, and it cannot distinguish the two above cited metacommunity features. On the other hand, measures based on  Brualdi and Sanderson's (1999)  discrepancy and Nc quantify nestedness only among columns or rows. Null models, simulated matrices and nestedness measures were generated and calculated by the software applications Aninhado (Guimara ˜es and Guimara ˜es 2006 Bwww.guimaraes.bio.br !), Cooc  (Ulrich 2007) , Nestedness  (Ulrich 2006a) , Matrix  (Ulrich 2006b) , and Nestedness programme (Acknowledgments).

Results


Model matrices
The four metrics showed clear differences in their degrees of nestedness for identical model matrices (Table  2 ). For the random model depicted in Fig.  3 , the mean degree of nestedness ranged from 0 for NC to 68 for Nd1, whereas both NT and NODF had values about 50. The analysis of the three nested matrices depicted in Fig.  3  demonstrated that T, C, and d1 do not discriminate a nested structure in which fill is minimum from others in which fill is maximum (Table  2 ). More troubling, however, was that both T and d1 quantified some degree of nestedness for structures in which nestedness does not actually exist, whereas C showed negative values for all but one non-nested structure (Table  2 ). Only NODF consistently revealed that these structures have no degree of nestedness (Table  2 ).

Simulated matrices
For our first type of random matrices, degrees of nestedness obtained by NODF were strongly related to matrix fill with a peak at around 90% fill. However, the metric is unrelated to matrix shape and size (Fig.  4AÁC ). NT and Nd1, on the other hand, were highly sensitive to variation in matrix shape and matrix size, but only Nd1 showed a monotonic increase with fill (Fig.  4DÁI ). For NT, 95.7% of the variance of its relationship with matrix fill can be explained by a quadratic fit. Thus, T is also highly dependent on matrix fill. Unlike their absolute values, the Z-scores of the four metrics obtained through the EE null model were only related to matrix fill (Fig.  5 ). In turn, Z-scores obtained through the FF null model were only slightly sensitive or even invariant to matrix fill, size and shape (Fig.  6 ). NODF correctly identified randomness for 93% and 99.5% of the non-nested matrices through the EE and the FF null models, respectively.  

Empirical matrices
The degrees of nestedness produced by the four metrics were moderately to strongly positively correlated (Fig.  7 ). NODF showed strong correlations with Nd1 and NC and a moderate correlation with NT (Fig.  7 ). Conversely, NT had the lowest bivariate correlations and higher point dispersions in their scatterplots. However, the distributions of their values were clearly distinct (Fig.  7 ) According to our new metric, most empirical matrices have degrees of nestedness between 40 and 70 (Fig.  7 ). Degrees of nestedness according to NODF were lower than those calculated using NT (Z 0(8.37, p B0.001) and Nd1 (Z 0(8.83, pB0.001). NT also produced higher degrees of nestedness when compared to Nd1 (Z 0(2.06, pB0.039). Respectively, 92.3% and 99.6% of the empirical matrices examined by NT and Nd1 had higher degrees of nestedness than NODF. These differences were similar when degrees of nestedness obtained by NT and Nd1 were compared to NODF only among sites and only among species occupancy (p B0.001 for the four comparisons). NODF identified 237 of the 287 empirical matrices as being significantly nested under the EE null model. On the other hand, under the FF null model NODF identified only three empirical matrices as being nested. NODF also indicated that nestedness in species occupancy (mean 054.0) is significantly lower than nestedness in species composition among sites (mean 060.6; Z 0(9.25, pB0.001).

Discussion
Why another metric? The occurrence of nestedness in ecological systems provides clues about the processes that affect species distributions among different sites and that shape interspecific interactions  (Lomolino 1996 , Leibold and Mikkelson 2002 , Thompson 2005 , 2006 , Lewinsohn et al. 2006 , Guimara ˜es et al. 2007b ). In addition, its quantification can be used to guide conservation strategies  (Atmar and Patterson 1993 , Cutler 1991 , 1994 , Boecklen 1997 ) and to understand the fragility and co-evolution of networks of ecological interactions  (Thompson 2005 , 2006 , Jordano et al. 2006 ). Therefore, it is fundamental to measure such structure properly. Given that several metrics and computational programs are currently available  (Cutler 1991 , 1994 , Atmar and Patterson 1995 , Lomolino 1996 , Wright et al. 1998 , Brualdi and Sanderson 1999, Hausdorf and   Here, we showed that current metrics are not sufficiently in accordance with the intuitive concept of nestedness as it was described above and understood by most authors  (Atmar and Patterson 1993 , Cutler 1991 , 1994 , Lomolino 1996 , Wright et al. 1998 , Brualdi and Sanderson 1999) . The aim of any nestedness metric is to quantify whether a given arrangement of presences and absences deviates or approximates from a perfectly nested pattern. They differ basically because (1) they measure distinct matrix properties (e.g. unexpected absences or holes, unexpected presences or outliers, and overlaps), and/or (2) they give different weights to these properties. However, the root of the inconsistencies found in the current metrics is associated with what these metrics consider to be a perfect nested pattern. Although most authors have explicitly pointed out what they mean by a nested pattern, what current metrics quantify is whether a matrix deviates from its own maximum degree of nestedness (Fig.  1 ) instead of from an independent maximum benchmark given by the two basic properties derived from the concept of nestedness: decreasing marginal totals, and paired overlaps. This is the reason why nested patterns with maximum fill or minimum fill have maximum nestedness according to T, C and d. Actually, it also occurs with the number of departures (D) proposed by  Lomolino (1996) , with the metrics N 0  (Patterson and Atmar 1986)  and N 1  (Cutler 1991) , and with the measures based on unexpected absences and/or presences  (Cutler 1991 , Wright et al. 1998) . Another inconsistency stemming from the relativization of the perfect nested benchmark is that these metrics implicitly assume that a column (or row) can be nested within another equally filled column (or row). For instance, a metacommunity characterized by few species-rich sites and a number of species-poor sites with identical species compositions is highly nestedness according to current metrics. Similarly, a metacommunity characterized by several 'fully-filled' (i.e. with identical species compositions) sites and a few speciespoor sites with distinct species composition also is highly nested according to current metrics. Thus, current metrics are not capable of distinguishing a perfectly nested matrix from a poorly nested one. In their paper introducing C, Wright and Reeves (1992) pointed out that nestedness 'occurs when the species present at sites inhabited by fewer species tend to be subsets of the biotas of richer sites'. However, C also counts the number of times in which a species' presence correctly predicts its presence at equally rich sites  (Wright et al. 1998) . Along similar lines,  Atmar and Patterson (1993)  made a clear distinction between nested structures with maximum decreasing fill, which they called maximally informative matrix, and minimum decreasing fill, which they called 'allwhite matrix' (Fig.  1  and 2 in  Atmar and Patterson 1993) . However, their metric T does not account for this important distinction. Rodrı ´guez-Girone ´s and Santamarı ´a's (2006) method, implemented in the BINMATEST program, differs from the algorithm used in the NTC only by the packing of the matrix (i.e. the arrangement of columns and rows to produce the lowest temperature), and by a modification of the isocline of perfect order. Thus this alternative procedure to calculate T also produces some degree of nestedness for the non-nested matrices illustrated in the Fig.  3  and does not solve the problem of inconsistency with the concept of nestedness. Although apparently trivial, when metrics give some degree of nestedness for pairs of columns or rows with identical marginal totals, they tend to produce higher degrees of nestedness in cases in which nestedness is actually low, as observed here for the empty and the full nested models (Fig.  3 , Table  2 ) and for the empirical dataset (Fig.  7 ). Another undesirable property of the metrics T, d and C is that they can produce distinct degrees of nestedness depending on which set (e.g. sites or species) is represented by columns and rows (Table  2 ). This is especially problematic for studies that aim to quantify nestedness simultaneously for columns and rows, as most studies on interaction networks do  (Bascompte et al. 2003 , Dupont et al. 2003 , Ollerton et al. 2003 , Guimara ˜es et al. 2006 , 2007a , 2007b) . The metric introduced here is directly based on the concept of nestedness, and consequently, it does not indicate nestedness in matrices in which there is no paired nested structure between columns and/or between rows (Table  2 ). On the other hand, the results showed in Table 2 confirm that T, C and d calculate some degree of nestedness for matrix structures where, clearly, no nestedness should be detected. In addition, NODF quantifies nestedness for columns and for rows independently, allowing thus to evaluate whether and how columns and rows contribute to whole-matrix nestedness (Table  2 , 3). Since most studies on metacommunities propose to test nestedness only among species composition or among species occupancies, the ability to discriminate these nestedness components is essential because it allows evaluating whether nestedness results from differences among sites and among species (Results on empirical matrices). In studies on species interaction networks, this property can be used to evaluate, for instance, the contribution of animals and plants to overall nestedness.

Diagnostic tests of the new metric
Our analyses on the relationship between matrix properties (fill, shape and size) highlight some important unexplored aspects of the behavior of current nestedness measures. NODF seemed to be sufficiently insensitive to matrix shape and matrix size, whereas both NT and Nd1 showed considerable dependence on these properties (Fig.  4 , Table  3 ). On the other hand, both NODF and Nd1 were positively correlated with matrix fill, and NT produced lower degrees of nestedness at intermediate fills for random matrices (Fig.  4 ; Rodrı ´guez-Girone ´s and Santamarı ´a 2006). Matrix fill corresponds to the degree of species occupancy in studies on metacommunities and to connectance in studies on species interaction networks (Table  1 ). It is important to note that the positive relationship between matrix fill and the degree of nestedness is not an analytical artifact, but simply a consequence of the concept of nestedness. Several other important attributes of metacommunity structure (e.g. beta-diversity, species occupancy and similarity in species composition) or properties of interaction networks (e.g. average path length, compartmentalization and degree distribution) are also intrinsically related to matrix fill. Although the relationship between Nd1 and matrix fill was quite similar to that for NODF, the former differed when fill approached 100% because the number of equally filled columns and rows increased, and NODF produced zero values for the degree of nestedness between pairs of equally filled columns or rows. Given these results, we assert that NODF is clearly superior to NT and Nd1 when absolute values of nestedness were used. When Z-scores instead of absolute values were used to measure degree of nestedness, we found that the four metric are virtually insensitive to matrix shape and matrix size (Fig.  5, 6 ). On the other hand, the four metrics were slightly sensitive to matrix fill under EE, but not under FF. Fig.  5  shows that the four metrics have inflated type I error rates when matrix fill is lower than 10%. Further studies have to clarify the relationships between these features and nestedness. The diagnostic tests to detect type I error rates associated with NODF showed that this new metric is more conservative than those recently examined by  Ulrich and Gotelli (2007a) . According to their analyses under the fixed-fixed null model, between 93% and 96% of the random matrices were correctly detected as not being significantly nested according to the eight metrics used, including T, N C and d. However, when the EE null model was used, the correct detection of randomness ranged from 3% to 42%. The percentage of random matrices for which randomness was correctly detected by NODF ranged from 99.5% under FF to 93% under the EE algorithm. Under the fixed-fixed model, therefore, NODF is slightly superior to the conventional metrics but it performs much better under the equiprobable null model.

Nestedness in empirical metacommunities
Our analysis of empirical matrices compiled by  Atmar and Patterson (1995)  showed that the degree of nestedness obtained by NT, NC and Nd1 are significantly higher than those calculated through NODF. A simple possible explanation for these differences is that a perfect nested matrix according to NODF needs to have 50% of 1's whereas the other metrics adjust their maximum values for the observed fill. However, this seems not be the case. These differences were also verified when we measured NODF exclusively for columns or for rows. Given that perfect nestedness only for columns or for rows do not need to have matrix fill close to 50%, the above mentioned analytical explanation does not prevail. In fact, a probable reason for these differences is the high number of columns and rows with identical marginal totals in the empirical matrices. These pairs of columns and of rows with identical marginal totals have no degree of nestedness according to NODF, but they can be perfectly nested according to the other metrics. We also showed that the degree of nestedness for species composition is higher than that for species occupancy. We Table  3 . Some characteristics of the four metrics for nestedness evaluated in this study. The three 'yes or no' answers for size, shape and fill correspond, respectively, to: (1) the absolute values calculated by each metric; (2) Z-scores under the equiprobable null model, and (3). Zscores under the fixed-fixed null model.

Does the metric
Nestedness metric T C d1 NODF depend on matrix fill? yes/yes/no yes/yes/Á yes/yes/no yes/yes/no depend on matrix shape? yes/no/no no/no/Á yes/no/no no/no/no depend on matrix size? yes/no/no no/no/Á yes/no/no no/no/no depend on which set is represented in columns or rows? yes yes yes hypothesized that the higher number of species present in one or two sites (endemics), as compared to the number of sites with a small fraction of species, is one of the major explanations for this pattern because there is no degree of nestedness for pairs of columns or rows with identical marginal totals.

Concluding remarks
There are a number of non-exclusive processes that can generate nestedness both in metacommunities and ecological networks, and these processes can be expressed across a wide range of temporal and spatial scales. Therefore, by using metrics that are not in agreement with the concept of nestedness there is a risk of overemphasizing the relevance of some ecological and evolutionary processes driving ecological systems or of making poor predictions. For instance, studies on interaction networks have predicted that both robustness against random extinctions and fragility against the loss of the most connected species increase at higher degrees of nestedness  (Memmott et al. 2004 , Burgos et al. 2007 ). Although highly nested networks are probably robust against random extinctions, they are certainly much less sensitive to the loss of the most connected species than truly scale-free networks  (Dunne et al. 2002 , Jordano et al. 2003) . For future studies on nestedness, we suggest that authors: (1) clarify whether they need to measure nestedness for the whole matrix or only for columns or rows; (2) explore whether nestedness is a general pattern of the community or derives from some particular species subset, and (3) reevaluate their previous conclusions, particularly those based on the matrix temperature, because this measure has several drawbacks  (Greve and Chown 2006 , Rodrı ´guez-Girone ´s and Santamarı ´a 2006,  Ulrich and Gotelli 2007a)  and is barely correlated to other nestedness metrics.