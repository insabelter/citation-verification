Introduction
In recent years, ab initio calculations based on the local density approximation (LDA) (for a recent review see, for example, Ref.  [1] ) have been of increased interest. The reasons for this development are evident: LDA offers a reasonable compromise between accuracy and efficiency in treating electronic many-body effects, is completely parameterfree, and with the enormous increase in computer power complex calculations are now feasible. Using the Hellmann-Feynman theorem  [2] , the calculation of forces is in principle straight forward and, for a basis set such as plane waves, relatively simple. The forces offer the possibility of relaxing atoms into their ground-state or of performing ab initio molecular dynamics (MD) simulations. With the computers now available, calculations for systems containing more than 100 particles are practicable, and the development of faster parallel computers offers a bright future for ab initio techniques. We have recently implemented a powerful LDA plane wave program (Vienna ab initio molecular dynamics simulation package (VAMP) -for a detailed description see Ref.  [3] ) which can be used to perform complex calculations for many problems (i.e., bulk, surfaces, liquid systems, molecules). In this paper we give a short review of existing methods, describe our approach and present new results for liquid Li, Na and A1. We also discuss the application of our method to liquid transition metals and to the transition from a liquid metal to an amorphous semiconductor by the rapid quenching of Ge.

Theory


General
* Corresponding author. Tel: +43-1 58801 5684. Telefax: +43-1 586 7760. E-mail: kresse@tph20.tuwien.ac.at. The basic quantity for an ab initio calculation of the structural and cohesive properties is the Kohn-Sham (KS) energy functional  [4]  

EKS[{~On},(RN}] = E fn(6n [Tq-gi°n 16n)
n -[-1EH[ [] -'b EXC[ p] "[-~Ewald, (1) where p(r) = E fn 16,(r) 1 2, (2) n and fn = 1 for occupied bands and fn = 0 for unoccupied bands. This functional depends on the position of the ions, R N, and the electronic wavefunctions, qS~, only. E H is the Hartree-energy, E xc is the exchange-correlation energy, V i°n is the ionic pseudopotential, T is the kinetic energy operator and YEwald is the Madelung energy of the ions. The most important property of the KS functional is that it is extremal in the groundstate with respect to arbitrary variations of the wavefunctions. Under the constraint of orthonormalization, variation with respect to the wavefunctions leads to the well known KS eigenequations. To calculate the electronic groundstate, several techniques were proposed. Among these the most elegant algorithms try a direct minimization of the functional: i.e., (a) the Car-Parrinello (CP) simulated annealing approach  [5] , especially well suited for a simultaneous update of ions and electrons; (b) steepest descent techniques and (c) conjugate gradient techniques, performing a minimization of the total energy; and (d) band by band methods optimizing a single band at a time. The essential characteristics of the different methods are: (a) Car and Parrinello  [5]  proposed a simulated annealing approach in which the electrons posses a fictitious classical kinetic energy. This makes it possible to follow simultaneously the time-evolution of the ionic coordinates R u and of the the electron eigenstates, by integrating the quasiclassical equations of motion derived from the CP-Lagrangian L=tx ~.,f~((b,l(b,)+ E ½MNRZu-EKs . (3) n N The mass, /x, controls the kinetics of the electronic degrees of freedom. The CP approach works well if the ionic and electronic frequencies are well separated, leading to an adiabatic decoupling of the electrons and ions. This is the case for insulators and semiconductors, but not for metals. In metals, energy is transferred irreversibly from the ions to the electrons causing the electrons to drift away from their groundstate  [6] . A solution to this problem is the attachment of two Nos6 thermostats  [7]  to the system, one for the ions and the other one for the electrons. The electronic thermostat reduces the kinetic energy of the electrons and causes the electrons to closely follow their exact groundstate. (b) It is now rather well established that at fixed ionic coordinates the KS functional has only one well defined global minimum. Therefore, it is not necessary to use global search algorithms -such as simulated annealing -to find the electronic groundstate. In general, steepest descent methods, in which the wavefunctions are changed along a (possibly preconditioned) gradient Ig,) =n14~,) -~ h,,,14'm), (4) m are better suited to solve such problems  [8] . (c) The convergence can be further improved using conjugate gradient techniques. The main difficulty arises from the orthonormality constraint for the wavefunctions, i.e., the wavefunctions must remain orthonormal during the optimization process. Conjugate gradient techniques do not allow such a constrained minimization. An elegant solution to the problem was first proposed by  Stich et al. [9] , and elaborated in Ref.  [10] . (d) A different technique in which each band is optimized separately was previously developed by Teter and co-workers  [11, 12] . Relaxing one band at a time saves computer memory; nevertheless the scheme is relatively time consuming because the charge density and potentials must be recalculated after each update of a single band. All the methods mentioned above work well for insulating and semiconducting systems. Since the bands above the Fermi level give no contribution to the total energy, only the n lowest bands, which are necessary to hold all electrons (i.e., n = nelect//2), must be generated within the minimization procedure. Methods (a) and (b) can be easily adapted to metallic systems (see for instance Refs.  [8, 13] ), but sometimes the convergence remains slow. For method (c), a generalization to metals was given in Ref.  [10] , but the algorithm is rather complicated (in addition, no solution was presented to the problem how to treat partial occupancies consistently during the optimization process). Method (d) cannot be generalized to metals. To treat metals more efficiently, we have implemented a different approach, which is similar to the traditional strategy for the solution of the KS equations by repeated diagonalization of the Hamiltonian, but where the direct diagonalization is replaced by an iterative optimization of the KS one-electron states  [3, 14, 15] . We start with a set of trial wavefunctions and a good initial guess for the charge density, Pin, (for instance the charge density of the free atoms) and set up the Hamiltonian for/kin. Then we improve the wavefunctions using an iterative matrix-diagonalization scheme. After optimization of all the bands, the new Fermi-energy, partial occupancies of the bands and a new charge density p (Eq. (  2 )) are calculated. The old Pin and the new charge density p are mixed, and a new effective one-electron potential is calculated. The iterative scheme is repeated until self-consistency is achieved (i.e., Pin = P)" This approach is perhaps less elegant than a direct minimization of the KS functional, but it is very reliable and leads to a stable solution, even for metallic systems with a high density of states at the Fermi level. It is especially efficient if used in conjunction with a finite-temperature LDA.

Finite-temperature density functional theory
At finite temperature, the proper variational quantity is the free energy, which is defined as  [1, [16] [17] [18]  F=E-Eo-S[{f,}], cr=k,T,  (5)  t~ where S is the Fermi-Dirac entropy of non-interacting electrons. At the groundstate, the free energy is a minimum with respect to variations of the wavefunctions and the occupancies, f,, of the oneelectron states. This results in a simple Fermi-Dirac occupation probability for the one-electron states. In the most cases, we found it more convenient to use a form for the entropy, S, which results in a Gaussian distribution of the occupancies around the Fermi level  [18] : a Gaussian decays much faster than the simple exponential Fermi-Dirac function, therefore it is possible to include less orbitals in the calculation. We should point out that the temperature of the electron gas and the width of the Gaussian are not always determined by the actual temperature of the system. For an ab initio MD, partial occupancies are mainly a tool to avoid problems connected with level crossing: At zero temperature, a crossing of two levels at the Fermi-edge causes a jump in the related occupancies from 0 to 1 and vice versa, resulting in a discontinuity in the total energy. In addition, a large smearing parameter o" (or a large T) can help to reduce the number of k-points in the irreducible wedge of the Brillouin zone which are necessary to get a well converged total energy for a metallic system. This is possible by extrapolating from finite-temperature to zero-temperature results  [18] , using E(T~ O) = (E+F)/2. In this case, the smearing parameter can be increased by an order of magnitude (for instance up to 1 eV for A1).

Iteratice diagonalization
Within each self-consistency loop, the wavefunctions are improved using an iterative matrix diagonalization scheme. We have tested the Davidson block-iteration scheme  [19]  and a method based on the band-by-band conjugate gradient techniques  [11, 20]  and have found that the conjugate gradient scheme is of superior efficiency. In addition, it requires less storage than the Davidson block-iteration scheme. In our implementation we closely follow Bylander et al.  [20] : starting from the lowest band, the expectation value of the Hamiltonian (4'. I HI ~)n)/(~) n I~n) is minimized sequentially for each band n under the usual orthonormality constraint with two or three standard conjugate gradient steps (more steps are not efficient, because the update of the charge density changes the Hamiltonian). We use a special preconditioning function, which accounts for the fact that the kinetic energy operator dominates the Hamiltonian for plane waves with a large q-vector  [11] . After a single sweep over all bands, the improved wavefunctions are transformed so that the Hamiltonian matrix is diagonal in the subspace spanned by the transformed wavefunctions. This step is critical for the calculation of the exact KS eigenstates and a correct determination of the new partial occupancies.

Charge-mixing
For bulk solids and liquids, we have found that a simple mixing scheme proposed by Kerker  [21]  resuits in an excellent convergence. For surfaces and molecules, this mixing is not sufficient. Therefore, we have recently implemented a more efficient Broyden scheme (For an excellent description of different mixing algorithms, see Ref.  [22] ; the actual implementation closely follows Refs.  [22, 23] .). The Broyden scheme results in very stable convergence cycles. Even in critical cases, such as surfaces, not more than 20 mixing steps are necessary to converge the total energy to within 10 -6 eV/atom. A selfconsistent calculation takes approximately two to three times as long as an evaluation of the KS eigenvectors for a fixed non-self-consistent Hamiltonian (same accuracy assumed).

Ultrasofi pseudopotentials
The first row elements (C, O, N, etc.) and the transition metals are hard to treat using standard pseudopotentials because they require a rather high energy-cutoff and a large number of plane waves (PW) per atom (PW > 300) to obtain accurate results. This problem can be solved by adapting the ultrasoft (US) pseudopotentials proposed by Vanderbilt  [24] . The new scheme is characterized by two main points. (i) It is possible to include more than one reference energy, E, per quantum state, l, guaranteeing an improved transferability over a wide energy range. (ii) US-pseudopotentials are no longer norm-conserving (NC). Both points together allow the use of large cut-off radii for the pseudowavefunctions and the 'softer' pseudowavefunctions make it possible to reduce the number of PW. Nevertheless, relaxing the norm-conservation constraint results in a charge-deficit between the pseudo-and the exact all-electron wavefunctions, which must be described using localized augmentation functions Qji(r). Second, an overlap operator has to be included in the orthonormality constraint and the KS eigenequations. Explicit formulas for the KS functional, the Hamiltonian, the forces and the stress tensor can be found in Refs.  [3, 25] . Our pseudopotentials (NC as well as US) are constructed using a modified Rappe scheme  [26] . Details can be found in Refs.  [3, 15, 27] .

Forces, relaxation and ab initio MD
Using forces and stresses, the relaxation into the instantaneous ionic groundstate is simple and is performed by applying conjugate gradient techniques or quasi-Newton algorithms  [28] . Ab initio MD simulations are possible as well. Due to our efficient minimization techniques, the exact evaluation of the finite temperature LDA groundstate is possible at each timestep, allowing us to use a much larger timestep than in CP calculations (the timestep within the CP-framework is restricted by the electronic kinetics). The effectiveness of a MD simulation can be further improved by extrapolating the wavefunctions and the charge density from old ionic positions to new configurations  [10, 29] . Using this extrapolation technique, the efficiency of our program is comparable to a conventional Car-Parrinello simulation. In addition we do not have problems treating metallic systems, which tend to be difficult within the CP approach (see Section 2). To allow the simulation of canonical ensembles, we include a Nos~ thermostat coupled to the ions. The mass of this thermostat is a critical parameter  [30]  and should be chosen such that the typical frequency induced by the heat bath is similar to the characteristic ionic frequencies.

Results
Since pair potentials give an excellent description of simple metals  [32] , nothing new can be expected from an ab initio MD simulation for these materials. Nevertheless, it is interesting to do such calculations (i) to test the accuracy of the LDA and its finite temperature extension and (ii) to see whether our technique (i.e., exact evaluation of the groundstate at each timestep) works fast and reliably. This is not clear per se and the first CP calculations for metals had to face serious problems (see Section 2). We have performed ab initio MD simulations for three typical free-electron metals, Na, A1 and liquid Ge, and also for Li. The electronic density of states (DOS) for Li shows a significant deviation from a a Using modified RRKJ scheme  [27, 3, 15] . b Using Vanderbilt scheme  [31] . c Using ultrasoft pseudopotential  [27, 3, 15] . free electron parabola and therefore our results might serve as a critical benchmark for calculations using classical pairpotentials. Technical parameters for each simulation can be found in Table  1 . The F point only was used for the Brillouin-zone (BZ) sampling, resulting in a rather inaccurate description of the differential DOS (i.e., pseudogaps in the DOS), but it seems to be sufficient for a good description of the interatomic forces. Li, Na and Ge were initially equilibrated using simple pair potentials  [32, 33] ; AI was melted from a simple cubic phase. For Na we have performed two model calculations, differing in the number of atoms. For the 54-atom ensemble, the Fermi-level falls into a pseudogap separating the highest occupied and the lowest unoccupied band at the F-point. Therefore, the characteristic difficulties in handling metallic systems do not appear. The 60-atom ensemble on the other hand is metallic. We found no differences in the conservation of the free energy, demonstrating that our techniques works equally well in both situations. In addition, the comparison demonstrates that the influence of the boundary conditions is small.

Discussion


Simple metals
In Fig.  1  we compare the pair correlation (PC) functions for Li, Na and AI with experimental data  [34] , and it may be seen that the agreement is in general very good. For Li, small differences between experiment and theoretical predictions are visible, but the accuracy (a)   , t,I ,i i iI~tlil li, t,Ii t i1! i i i i i L i iii ili ~ 0 2 4 6 8 R c~) or" ran Itlllltllll~d~ 0 2 [b) %/ rllllltal,, ,Ill ,,,ltlltlnllllillt 4 6 8 R c~) C~ 2 [c] 0 "ll J lllllil~ ill ,, ,I, ,iLlllltl h Jilllltt 0 2 4 6 8

R c~
;, , ~' J ;i 1 ~ .6 i i , 7,, :> }', : ,, q] cn .2 ; ; /t 1 ; l ~- -4 -3 -2 -1 E leV) Fig.  2 . Electronic density of states for 1-Li and bcc-Li. ---crystalline DOS; ...... , liquid DOS calculated from the eigenvalues at the F-point with Gaussian broadening; --, liquid DOS calculated on a 6 X 6 X 6 grid of k-points. of the experiment is not as good as for Na. Fig.  2  shows the DOS for Li. To improve the accuracy of the k-point sampling, we have also carried out calculations for a small number of configurations on a 6 X 6 X 6 grid in the irreducible wedge of the simple cubic-BZ (10 k-points). The resulting DOS is smooth and shows the narrowing of the occupied part of the band and the structure induced DOS-minimum just above E r. Our calculation also leads to a good description of the dynamical properties, e.g., the self-diffusion constant D = 0.7 X 10 -4 cm 2 s -1 is in excellent agreement with experimental data D = 0.65 X 10 -4 cm 2 s -1  [35] .

Transition metals
The simulation of transition metals is a challenging task  [36] , and calculations are feasible using the US pseudopotentials, discussed in Section 2.5. Applying these potentials, the number of PW per atom is approximately the same as for simple metals (i.e., = 50-100 PW/atom), but due to the large number of bands the computational effort remains massive and an o(N 3) scaling is found even for relatively small systems (> 50 atoms). Exact parameters for calculations for liquid Copper and liquid Vanadium are compiled in Table  1 ; the results were published elsewhere (see Ref.  [15] ). For l-Cu we found an excellent agreement between experiment and theory, whereas the the agreement was less spectacular for V. Compared with the exper-iment, the positions of all peaks were shifted inward by approximately 6%. The shift is partly due to errors in the LDA. (The error in the equilibrium volume is almost 10% for V.) Second, the experimental data for V are of limited accuracy, due to difficulties arising from the high temperatures.

Liquid-metal to amorphous-semiconductor transition in Ge
The simulation of the transition from a metallic to a semiconducting phase requires accurate forces for very different conditions. Pair potentials are not sufficient to reproduce the transition  [37] . Quite successful calculations for Si using the CP approach were previously published by Stich and co-workers  [38] . We have decided to study the transition for Ge, applying our new MD technique (details were published in Ref.  [39] ). The cooling process, which took approximately 8 ps, was started from a well equilibrated liquid model system (T = 1250 K). The final temperature was T = 300 K. After quenching, we obtained a structure with a relatively large number of defects. Therefore, we tried to improve our model by reannealing the system (i.e., heating up to 600 K for 3 ps). To investigate the inherent defects, we also calculated two T= 0 configurations, using local search algorithms (see Section 2.6). In Figs.  3  and 4  we show theoretical and, if available, experimental results for the pair correlation functions and angular distribution functions for the liquid and the annealed amorphous state. From the analysis of the DOS, we found 1-Ge to be metallic. The structure of l-Ge is rather open (coordination number N c = 6.0). Beyond the first peak, almost no oscillations are visible in the pair correlation function; similarly, the angular distribution shows only weak structure other than the excluded volume peak at 60 ° and a flat maximum close to the tetrahedral bond-angle (random packing would correspond to a straight line in the angular distribution function). These results are an indication that only short range correlations exist in the liquid phase. Our amorphous structure (Fig.  4 ) agrees well with experimental data, but the number of defects is larger than inferred from the diffraction experiment. The coordination number is close to 4 and the bond angle distribution is peaked around 108 ° , corresponding to a tetrahedral packing. The DOS shows -as expected a gap at the Fermi edge. In addition to the static properties, we have calculated some dynamical properties. The diffusion constant is approximately D = 1.0 X 10 .4 cm 2 s 1 for the liquid state and drops to less than 5% of its initial value for T = 650 K. We have also calculated the spectrum of the velocity-autocorrelation function for the amorphous state and found an excellent agreement with availible experimental data. The analysis of defects is probably the most interesting topic. At T = 300 K, the number of threeand fivefold sites (T3 and T5) changes during the simulation. We have tried to improve the analysis by calculating T = 0 structures. Nevertheless, the analysis based on geometric arguments (i.e., bond length) alone remains controversial, because the minimum in r~ ~o  (a]  I n i i i I i i~ i i I i , , i I i i i ~ ] i i i i i i i i i i i h r i  Fig.  4 . Same as Fig.  3 , but for annealed amorphous Oe at T = 300 K (neutron diffraction -Ref.  [40]  for g(R)). g(R) is not sharply defined even at zero temperature. Visualization of the charge density around a central atom resulted in a clearer characterization of 'bonding' defects. We found T 3 (sometimes called dangling bonds sites) and T 5 sites. T 5 sites tend to have three or four strong and two or one weak bonds: if an additional atom is squeezed into a tetrahedral configuration other bonds are weakened.

Conclusion
The calculations presented in this paper show that MD simulations for most liquid systems -including liquid transition metals -are feasible using modern ab initio MD codes. The finite temperature LDA helps to avoid band crossing problems during an ab initio MD simulation. In conjunction with the exact evaluation of the electronic groundstate at each timestep, even metals with a high density of states at the fermi-level can be treated without the difficulties existing within the CP approach. US pseudopotentials offer for the first time the possibility of treating transition metals and first row elements on the same basis as simple metals. Using all refinements, the efficiency of our code is at least comparable to a conventional CP-program. Currently, several calculations for surfaces, molecules, molecular crystals and liquid and amorphous alloys are under progress. Despite the advantages of the LDA-PW approach, there still remains one unsolved problem, i.e., the o(N 3) scaling with the number of atoms, N. Using PWs no solution to this problem seems to be possible. At the moment, only simple non-self-consistent tight-binding calculations promise to show an o(N)-scaling in the density-matrix formulation  [41] . Nevertheless, in terms of accuracy and because there are several ambiguous parameters these techniques are not comparable with LDA-PW calculations.