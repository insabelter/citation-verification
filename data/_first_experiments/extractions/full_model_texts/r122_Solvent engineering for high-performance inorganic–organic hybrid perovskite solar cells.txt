Evaporation and the convective self-assembly process during spinning immediately induce the formation of well-crystallized perovskite materials due to strong ionic interactions between the metal cations and halogen anions. Generally, γ-butyrolactone (GBL), N ,N -dimethylformamide, DMSO and N -methyl-2pyrrolidone are used as effective solvents for lead halides and MAI. However, simple spin-coating did not yield a homogeneous perovskite layer having uniform thickness over a large area 
20  , although the convective spreading flow due to centrifugal force was applied to the slowly evaporating solvents. Previously, we reported the formation of a pillared structure with an island-type upper layer  10  , and proposed the importance of a homogeneous upper layer on the mp-TiO 2 base; however, we were unable to deposit uniform thin films by the solution process. Furthermore, it was reported that the uniformity of the perovskite films depended on the thickness of the TiO 2 compact layer, and modification of the spinning conditions could not achieve 100% surface coverage  20  . This limited the applicability of the solution process. Here, we report the solution-process fabrication of efficient perovskite solar cells comprising a bilayer architecture and MAPb(I 1-x Br x ) 3 perovskites formed by a solvent-engineering technology. The MAPb(I 1-x Br x ) 3 perovskite composition was used because the substitution of 10-15 mol% Br -for I -in MAPbI 3 greatly improved the stability in ambient atmosphere, and the dual halide material demonstrated similar performance over the compositional range  13  . When the perovskite was deposited using a mixture of GBL and DMSO, followed by a toluene drip while spinning, extremely uniform and dense layers were formed. This solvent-engineering technology enabled a fully solution-processed perovskite solar cell with a certified 16.2% power-conversion efficiency under standard reporting conditions. Figure  1  presents a schematic diagram of the cell architecture and deposition of perovskite materials by the solvent-engineering technology by means of spin-coating, as well as X-ray diffraction (XRD) patterns of the resulting coatings. The cell architecture (Fig.  1a ) reveals a bilayer structure comprising mesoscopic and planar structures, and is effective for sufficiently absorbing light and collecting charges. Atop the mp-TiO 2 layer lies a highly uniform perovskite active layer (100-300 nm thick). Poly(triarylamine) (PTAA) and Au metal were next deposited on the active layer as a hole-transporting material and photocathode, respectively. For this architecture, the formation of a homogeneous thin perovskite layer is extremely important, and we developed our solvent-engineering technology as an effective tool for creating such a layer. The process involves five stages, as depicted in Fig.  1c . First, a mixture of MAI, MABr, PbI 2 , PbBr 2 , GBL and DMSO in the appropriate ratio is spread over the entire surface of the substrate. Second, the spin-coater is accelerated to the desired rotational speed and maintained there for several tens of seconds to evaporate the solvent. Third, a solvent that does not dissolve the perovskite materials and is miscible with DMSO and GBL (for example, toluene or chloroform) is dripped on the substrate during spinning. Fourth, all constituents are frozen into a uniform layer on the removal of the residual DMSO and then a new complex as an intermediate phase is formed (see below). Finally, the complex is converted into highly uniform and crystalline perovskite on annealing at 100 • C for 10 min (Fig.  1b ). As is apparent from Supplementary Fig.  1 , the morphology of the perovskite thin layer is markedly changed by this solvent-engineering process, as compared with model systems on quartz substrate. In pure GBL, the perovskite crystals formed immediately, and the colour of the film on the substrate changed to dark hazy brown during rotation at 5,000 r.p.m, regardless of the application of the toluene drip. The resulting morphology appears as inhomogeneous islands with low coverage on the substrate (Supplementary Fig.  1a ). In contrast, in the DMSO and GBL mixed solvent, the colour change to dark brown is not observed during spin-coating, even after 5 min rotation. The spin-coated layer formed with the solvent mixture followed by the toluene drip is extremely uniform and transparent, and covers the full surface with low surface roughness. Without the toluene drip treatment, the resulting material adopts a textile-like inhomogeneous layer that does not fully cover the substrate, and perovskite crystals are formed from the coating after annealing at 100 • C (Supplementary Fig.  1b ). Here, the crystallinity of the perovskite films is almost the same regardless of the toluene drop-casting, as can be seen in values of full-width at half-maximum of (110) XRD peaks of Supplementary Fig.  2 . Therefore, the solvent-engineering technique is critically important for this process. To gain further insight into the mixed-solvent application and subsequent toluene drip treatment, we isolated the intermediate phase formed by pouring MAI and PbI 2 dissolved in GBL and DMSO into toluene. In this experiment, we excluded the doping of MABr and PbBr 2 to simplify our analysis. The XRD profiles shown in Fig.  2a  imply that the resultant intermediate phase is selforganized and highly crystalline in nature. Therefore, we think that the phase formed on toluene drop-casting in step 3 of Fig.  1c  has a well-developed crystalline form. To get further information for the phase, we compared it with the XRD patterns for PbI 2 , MAI and PbI 2 (DMSO) 2 , because the constituents in the mixed solvent can be simply precipitated in the non-dissolving solvent. Here, PbI 2 as a layered semiconductor material contains a plane of Pb ions sandwiched between adjacent layers of hexagonally arranged iodide ions. The interlayer spaces allow rapid intercalation of different guest molecules owing to the weak bonding between the two planes by van der Waals-type interactions, leading to the expansion of the interlayer distance along the c axis  21  . It was known that the DMSO used as a solvent in this work can coordinate with lead halide to form a PbI 2 (DMSO) 2 complex  22  . However, as can be seen in the figure, the isolated powder is a new and unreported compound that cannot be assigned to reported materials, and is related to the intermediate phase formed during perovskite deposition from DMSO and GBL. Thus, we considered a MAI-PbI 2 -DMSO complex as a possible crystalline compound that can be formed from the solution mixture. In the DMSO and GBL solution mixture, GBL functions purely as a solvent, which has a relatively higher evaporation rate than DMSO during spinning; XRD patterns of the intermediate phase completely matched the material isolated from DMSO in the absence of GBL.  On the basis of the above observations, we propose a plausible mechanism for the formation of the uniform and dense perovskite layer during spin-coating from MAI, PbI 2 and DMSO with a toluene drip treatment. As shown in Fig.  2d , at the initial stage during spinning, the film is composed of MAI and PbI 2 dissolved in the DMSO/GBL solvent mixture, whereas in the intermediate stage, the composition of the film is concentrated by the evaporation of GBL. Then the toluene droplets lead to the immediate freezing of the constituents on spinning via the quick removal of the excess DMSO solvent and the rapid formation of the MAI-PbI 2 -DMSO phase, leaving a uniform and transparent thin layer (Supplementary Fig.  1d ). The role of DMSO in the MAI-PbI 2 -DMSO phase is to retard the rapid reaction between PbI 2 and MAI during the evaporation of solvent in the spin-coating process. Finally, the extremely homogeneous flat film (shown in Fig.  3a ) is converted into a pure crystalline MAPbI 3 perovskite layer after annealing at 100 • C. In this process, the key material is the flat film consisting of MAI-PbI 2 -DMSO. These behaviours do not change by using the mixed-halide materials, MAPb(I 1-x Br x ) 3 (x = 0.1-0.15). Accordingly, the formation of the intermediate phase is a critical factor for smoothing the surface via dropwise toluene application, which finally results in compact and uniform thin layers. Figure  3  illustrates images obtained by atomic force microscopy (AFM) for the intermediate film and the perovskite film on fused silica substrate, and field-emission scanning electron microscopy (SEM) images of the surface of the perovskite upper layer and the crosssection of a representative cell formed by our solvent-engineering technology. As can be seen in the three-dimensional AFM images and topography of Fig.  3a ,b, the root mean square roughness values for the intermediate phase and crystalline perovskite layer are 6.0 and 8.3 nm, respectively, even though the formation of the perovskite from the intermediate layer gave slightly increased roughness. In Fig.  3c , we can observe that the surface exhibits a dense-grained uniform morphology with grain sizes in the range 100-500 nm. The entire film is composed of a homogeneous, wellcrystallized perovskite layer. In addition, from a typical crosssectional SEM image of a real device, we can see two uniform layers consisting of a TiO 2 /perovskite nanocomposite and the pure perovskite (Fig.  3d ); the perovskite materials are fully infiltrated into the pores of the mp-TiO 2 film, and also deposited in a very uniform thick film with 100% surface coverage atop the mp-TiO 2 , compared with the conventional method  10, 11  . To fabricate efficient solar cells, the active layer of the light harvester must be thick enough to absorb sufficient incident light. Fortunately, the high absorption coefficient (Supplementary Fig.  4 ) of a perovskite light absorber film allows the use of very thin layers (∼330 nm thick) to absorb the entire range of visible light. Indeed, the authors of ref. 12 fabricated a highly efficient thin solar cell exceeding 15% efficiency with a perovskite absorber (MAPbI 1-x Cl x ) of ∼300 nm without mp-TiO 2 , and reported that the MAPbI 1-x Cl x perovskite had a long diffusion length (>1 µm; ref. 17). These results encouraged us to fabricate a thin-film solar cell using MAPb(I 1-x Br x ) 3 (x = 0.1-0.15) with a thickness of 350 nm in the absence of mp-TiO 2 . We were able to fabricate thin-film solar cells with extremely uniform, dense layers (Fig.  3a-c ) by our solvent-engineering technology. Figure  4a  presents the I -V curves for a cell fabricated without the mp-TiO 2 layer, measured with a 40 ms scanning delay in reverse (from the open-circuit voltage (V oc ) to the short-circuit current (I sc )) and forward (that is, from I sc to V oc ) modes under standard airmass 1.5 global (AM 1.5 G) illumination. Table  1  summarizes the extracted short-circuit current density (J sc ), V oc and fill factor (FF). Apparently, there is a large hysteresis and distortion in the I -V curves. The J sc , V oc and FF values obtained from the I -V curve of the reverse scan were 19.2 mA cm -2 , 1.09 V and 0.69, respectively, yielding a PCE of 14.4% under standard AM 1.5 conditions. In contrast, the corresponding values from the I -V curve of the forward scan were 19.2 mA cm -2 , 1.07 V and 0.44, respectively, showing a pronounced discrepancy of 9.1% in overall efficiency. Such hysteresis and the discrepancy result in the underestimation of the real J -V curves in the forward scan and overestimation in the reverse scan. Typically, reliable solar cell I-V measurements should exhibit coincident curves for both the forward and reverse scans. In some cases, depending on the cells, the measurements must be carried out with longer scanning delays. Thus, the efficiencies for the cell without the mp-TiO 2 layer were compared between the forward and reverse scans at various delay times ranging from 10 to 300 ms. As can be seen in Supplementary Fig.  5a  the efficiency decreased from 11.0 to 7.0% in the forward scan and from 16.5 to 8.5% in the reverse scan, as the delay time increased from 10 to 300 ms. The efficiencies did not approach similar values even when the scan time was long. Furthermore, the average efficiency from the reverse and forward scans continued to decline with increasing delay time. Thus, the large discrepancy and discordance with scan direction and delay time can induce a considerable error in evaluating cell efficiency. In contrast, the J -V curves of the forward and reverse scans of the cell with the bilayer architecture {FTO/blocking layer (bl)-TiO 2 /mp-TiO 2 (∼200 nm)/upper layer (∼200 nm)/PTAA (50 nm)/Au} (Fig.  4b ) were well coincident. Moreover, the efficiency and average efficiency from both scan directions were symmetrical and identical regardless of the scanning direction, and results using a significantly shorter delay time were coincident with those from a cell lacking the mp-TiO 2 (Supplementary Fig.  5b ). The J sc , V oc and FF values obtained from the I -V curves of Fig.  4b  for the reverse and forward scans are summarized in Table  1 , and the overall efficiencies for both scan directions under the standard method are 15.8 and 15.9% with an average of 15.85%, clearly showing the reliability of the I-V measurements. Generally, the average value of the efficiency, determined from the forward and reverse scans should be widely accepted when the scanning delay time is longer than 40 ms (ref. 23), because an excessively long time to complete the measurement is impractical. For a deeper understanding of the dependence of the I -V parameters on both scan directions, we investigated the difference between the forward and reverse scans for a 40 ms scan time as a function of the thickness of the mp-TiO 2 layer. As the layer thickness increased to ∼200 nm, the difference in efficiency between the forward and reverse scans reached a minimum, and then again deviated slightly with continuing mp-TiO 2 thickness 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 1. 1   increases (Fig.  4c ). Interestingly, the efficiency measured in the reverse scan did not vary greatly with the mp-TiO 2 thickness, whereas the forward scan yielded a pronounced variation, resulting in a large discrepancy between the two scan directions. Such a strong dependence of the measured efficiency on the scan direction with mp-TiO 2 thickness suggests that solar cells fabricated from MAPbX 3 perovskite materials operate differently than other types of cells such as organic, dye-sensitized, and conventional Si solar cells. The stepwise increase or decrease in the bias voltage, corresponding to a reverse or forward scan, respectively, requires a charge redistribution to reach a new equilibrium state. These characteristics of perovskite solar cells may be related to the large diffusion capacitance of such cells operating under reverse or forward biases  24  . The large capacitance is assumed to be related to the underestimation in the forward scan and overestimation in the reverse scan by charging and discharging during the voltage sweep in the solar cells. In other words, the generated charge (electrons or holes) may persist in the perovskite owing to the slow charge collection in the thick perovskite layer, and require significant time for charge distribution. This would impede a quick response to the rapid scanning of the applied voltage for the I -V measurements. Therefore, the slow charge collection via the perovskite material itself must be improved to eliminate the large discrepancy with scan direction, and an optimally thick mp-TiO 2 layer must be introduced for efficient charge collection from the perovskite via the large TiO 2 interface. Eventually, it will be very important to impart effective charge collection and light absorption properties through a balance in the ratios between the perovskite-infiltrated TiO 2 layer and the thin upper layers. Of course, the tendency for discrepancy according to scan direction can be related to the perovskite composition, because the exciton diffusion length was markedly changed by doping Cl ions into MAPbI 3 (ref. 17).

NATURE MATERIALS
To further enhance the performance of our cells fabricated by solvent engineering, we repeated the fabrication procedure using mp-TiO 2 with a thickness of ∼200 nm. The J -V curves and incident photon-to-current efficiency (IPCE) spectrum of the best performing solar cell are presented in Fig.  5 . The average values from the J -V curves from the reverse and forward scans (Fig.  5a ) exhibited a J sc of 19.58 mA cm -2 , V oc of 1.105 V, and FF of 76.2%, corresponding to a PCE of 16.5% under standard AM 1.5 G conditions. The best device also showed a very broad IPCE plateau of over 80% between 420 and 700 nm, as shown in Fig.  5b . The J sc value integrated from the IPCE agreed well with that measured by I -V . In Fig.  5c  a histogram of the average PCEs for all of the independently fabricated cells contributing to our study is presented. Around 80% of the cells made using our process exhibited an overall efficiency exceeding of 15% under 1 sun conditions, proving the conceptual validity of a balanced thickness between the TiO 2 and thin upper layers. In addition, an evaluation of the available results allows us to conclude that this solvent-engineering approach provides a simple and effective means for realizing highefficiency and low-cost perovskite-based solar cells. One of these devices was certified by the standardized method in a photovoltaics calibration laboratory, confirming a PCE of 16.2% under AM 1.5 G full sun (Supplementary Fig.  6 ). In summary, we developed a solvent-engineering technology for the deposition of extremely uniform perovskite layers, and demonstrated a solution-processed perovskite solar cell with 16.5% PCE under standard conditions (AM 1.5 G radiation, 100 mW cm -2 ). We proposed a plausible mechanism for the formation of uniform and dense perovskite layers during the solvent-engineering process. The formation of a stable MAI(Br)-PbI 2 -DMSO phase via an intercalation process during the dropwise application of a non-dissolving solvent was a decisive factor in retarding the rapid reaction between MAI(Br) and PbI(Br) 2 , which enabled the formation of a highly uniform and dense surface. Furthermore, we found that thick perovskite cells fabricated without mp-TiO 2 showed a large hysteresis and distortion between reverse and forward scans, and raised arguments about the estimation of conversion efficiencies for perovskite cells. Hence, the ratio of the thicknesses of the perovskite-infiltrated mp-TiO 2 and the pure perovskite should be optimized to fabricate efficient perovskite cells with coincident reverse and forward scans. These results will provide an effective strategy for forming uniform PbI 2 -based perovskite layers through intercalation, and lead to more efficient and costeffective inorganic-organic hybrid heterojunction solar cells in the future.

Methods


Solar cell fabrication.
A dense blocking layer of TiO 2 (bl-TiO 2 , ∼70 nm in thickness) was deposited onto a F-doped SnO 2 (FTO, Pilkington, TEC8) substrate by spray pyrolysis, using a 20 mM titanium diisopropoxide bis(acetylacetonate) solution (Aldrich) at 450 • C to prevent direct contact between the FTO and the hole-conducting layer. A 200-300-nm-thick mesoporous TiO 2 (particle size: about 50 nm, crystalline phase: anatase) film was spin-coated onto the bl-TiO 2 /FTO substrate using home-made pastes  14  and calcining at 500 • C for 1 h in air to remove organic components. CH 3 NH 3 I (MAI) and CH 3 NH 3 Br (MABr) were first synthesized by reacting 27.86 ml CH 3 NH 2 (40% in methanol, Junsei Chemical) and 30 ml HI (57 wt% in water, Aldrich) or 44 ml HBr (48 wt% in water, Aldrich) in a 250 ml round-bottom flask at 0 • C for 4 h with stirring, respectively. The precipitate was recovered by evaporation at 55 • C for 1 h. MAI and MABr were dissolved in ethanol, recrystallized from diethyl ether, and dried at 60 • C in a vacuum oven for 24 h. The prepared MAI and MABr powders, PbI 2 (Aldrich) and PbBr 2 (Aldrich) for 0.8 M MAPb(I 1-x Br x ) 3 (x = 0.1-0.15) solution were stirred in a mixture of GBL and DMSO (7:3 v/v) at 60 • C for 12 h. The resulting solution was coated onto the mp-TiO 2 /bl-TiO 2 /FTO substrate by a consecutive two-step spin-coating process at 1,000 and 5,000 r.p.m for 10 and 20 s, respectively. During the second spin-coating step, the substrate (around 1 cm × 1 cm) was treated with toluene drop-casting. A detailed time-rotation profile for the spin-coating is represented in Supplementary Fig.  1c . The substrate was dried on a hot plate at 100 • C for 10 min. A solution of poly(triarylamine) (15 mg, PTAA, EM Index, M w = 17,500 g mol -1 ) in toluene (1.5 ml) was mixed with 15 µl of a solution of lithium bistrifluoromethanesulphonimidate (170 mg) in