I. INTRODUCTION
Semiconductor devices play an important role in modern technologies, and the rapid development of electronic structure theory methods has made computational design of such devices possible. The band gap and the band structure are undoubtly the most important properties of semiconductors, since these are the properties that distinguish semiconductors from other periodic systems  1  . Computational evaluation of the band gap and the band structure is thus a topic of active research. The fundamental band gap is a ground-state property, and it is defined as E g = I -A, where I is the ionization energy, and A is the electron affinity. I and A are groundstate energy differences. E g is also an excited-state property since it is the unbound limit of the exciton series. E g is very difficult to calculate for periodic systems, since there is no systematic way of adding/removing one electron to/from the solid in a periodic calculation, and the bulk limit can only be approached by the calculation of very big clusters. Many-body methods such as the GW method 2 calculate E g and the quasiparticle band structure accurately, but the computational cost is high. The density-functional theory (DFT)  [3] [4] [5]  is a formally exact electronic structure method for the ground-state energy and electron density with an excellent balance of accuracy and computational efficiency, which is achieved by mapping the real interacting system to a fictitious Kohn-Sham (KS) system of non-interacting electrons with a multiplicative effective exchange-correlation (xc) potential (the functional derivative of the exchangecorrelation energy with respect to the density). The exact Kohn-Sham potential yields the exact density but not the exact quasi-particle band structure and gap. Though the exact energy functional of the DFT is unknown, there exists a plethora of approximations, which has been ordered into the 'Jacob's ladder'  6  hierarchy. The first and the second rungs of the Jacob's ladder are the local density approximation (LDA) and the generalized gradient approximation (GGA), and they severely underestimate the fundamental gap in periodic systems. For periodic systems, KS DFT cannot calculate E g from its definition, and one commonly approximates E g with the KS gap E KS g = ǫ KS LUMO -ǫ KS HOMO , where ǫ KS HOMO and ǫ KS LUMO are the KS orbital energies of the highest occupied orbital and of the lowest unoccupied orbital, respectively. However, E KS g is not equal to E g even with the exact functional, due to the derivative discontinuity (DD)  7  . The band gap problem has been an obstacle in the application of DFT to periodic systems. The generalized Kohn-Sham (gKS)  8  scheme is a different formulation of the DFT, which allows a nonmultiplicative but still Hermitian xc potential operator. The gKS gap E gKS g = ǫ gKS LUMO -ǫ gKS HOMO can be a better approximation to E g than is the KS gap  9  . The third rung of the Jacob's ladder, the meta-generalized gradient approximation (meta-GGA), is commonly implemented in the gKS scheme according to the method of Neumann, Nobes and Handy (also denoted as gKS in this paper)  10  . The gKS meta-GGA band gap of periodic systems improves  11  over the KS GGA gaps as expected. In this work we find that, with the recently proposed strongly constrained and appropriately normed (SCAN) functional  12, 13  , the gKS meta-GGA gap corrects about 20%∼50% of the difference between the experimental fundamental gap and the GGA KS gap. Due to the restriction in the functional form of GGA, a GGA cannot perform well for finite systems and periodic systems at the same time. 14 On the other hand, the functional form of meta-GGA can satisfy more exact conditions and has a wider range of applicability than the GGA form. The SCAN functional is a non-empirical functional that satisfies all known exact constraints appropriate to a semilocal functional, and is expected to perform well for systems with very different kinds of bonds. The computational accuracies of the SCAN functional for many properties improve over those of the GGAs, with only marginal increase of computational cost.  12  We find that SCAN also improves band gaps, but the comparsion is between meta-GGA gKS gaps and GGA KS gaps, which are not the same quantity. It is unclear whether the KS gap itself is improved, or just the gKS gap is improved. One needs to do meta-GGA calculations in the KS scheme to be able to have a systematic comparsion of the KS band gaps between meta-GGA and GGA. In the gKS formalism for an orbital functional such as a meta-GGA or hybrid functional, we find the "optimal variational potential", a non-multiplicative self-adjoint operator that minimizes the energy functional with respect to the orbitals. This potential is a differential operator for a meta-GGA and an integral operator for a hybrid functional. In the KS formalism for an orbital functional, we find the optimized effective potential (OEP)  15, 16  , the multiplicative xc potential that minimizes the energy. The OEP meta-GGA yields the KS gap of the meta-GGA, which can be compared directly with the GGA KS gap. With the OEP, the meta-GGA xc potential also becomes comparable with that of the GGA. The OEP meta-GGA has been studied only in finite systems previously.  17, 18  In this work, we provide the first study of the OEP meta-GGA in periodic systems. We find that the meta-GGA KS gap is not significantly improved over the GGA KS gaps, and the band structure of the OEP meta-GGA is very close to that of the GGA (and presumably to that of the exact KS potential). The xc potential of the meta-GGA has more details than that of the GGA, but the change is not as big as the change between the LDA and the GGA. Though the gKS meta-GGA is known to be sensitive to the real-space grid used in the calculation, we find that the OEP meta-GGA has worse grid sensitivity. The reason for the grid sensitivity is discussed in this work. Within the gKS implementation of the meta-GGA form, it is possible to fit to energy gaps of solids  19  , and the result can be useful for the prediction of gaps  20  . But the fact that a property can be fitted in DFT is not evidence that it should be, or that other and more appropriate properties will not deteriorate as a result.

II. OEP META-GGA IN PERIODIC SYSTEMS


A. Theory
The meta-GGA xc energy functional has the form E XC [n ↑ , n ↓ ] = d 3 re XC [n ↑ (r), n ↓ (r), ∇n ↑ (r), ∇n ↓ (r), τ ↑ (r), τ ↓ (r)], (1) where e XC is the xc energy density, and n σ and τ σ are the spin density and the kinetic energy density of spin σ respectively. n σ and τ σ are n σ (r) = 1 Ω BZ i BZ d 3 k θ iσ (k) |ψ ikσ (r)| 2 , (2) τ σ (r) = 1 2Ω BZ i BZ d 3 k θ iσ (k) |∇ψ ikσ (r)| 2 , ( 3 ) where Ω BZ is the volume of the first Brillouin zone (BZ), i is the band index, ψ ikσ is the KS orbital normalized in one unit cell, and  θ iσ (k) = θ[E F -ǫ ikσ ] v XC,σ (r) = δE XC δn σ (r) = ∂e XC ∂n σ (r) -∇ • ∂e XC ∂∇n σ (r) + d 3 r ′ ∂e XC ∂τ σ (r ′ ) δτ σ (r ′ ) δn σ (r) . (4) Eq. (  4 ) can be partitioned into a GGA-like part and a τ -dependent part: v XC,σ (r) = v GGA XC,σ (r) + v τ -dep XC,σ (r). ( 5 ) v GGA XC,σ is a multiplicative potential, but v τ -dep XC,σ does not have a closed form. v τ -dep XC,σ can be written as v τ -dep XC,σ (r) = 1 Ω BZ i BZ d 3 k V cell d 3 r ′ d 3 r ′′ ∂e XC ∂τ σ (r ′ ) × δτ σ (r ′ ) δψ ikσ (r ′′ ) δψ ikσ (r ′′ ) δn σ (r) + c.c. . (6) On one hand, the gKS meta-GGA potential operator is obtained by multiplying both side of Eq. (  6 ) by δn σ (r)/δψ ik ′ σ ′ (r 1 ) + c.c and integrating over r: v τ -dep XC,σ (r)ψ ikσ (r) = - 1 2 ∇ • ∂e XC ∂τ σ (r)∇ψ ikσ (r) ≡ vgKS XC,σ ψ ikσ (r). (7) On the other hand, inserting δψ ikσ (r ′′ ) δn σ (r) = V cell d 3 r 1 δψ ikσ (r ′′ ) δv S,σ (r 1 ) δv S,σ (r 1 ) δn σ (r) , (8) where v S is the KS potential, into Eq. (  6 ) yields the OEP integral equation for v τ -dep XC,σ : V cell d 3 r v τ -dep XC,σ (r) δn σ (r) δv S,σ (r 1 ) + c.c. = 1 Ω BZ i BZ d 3 k V cell d 3 r ′ d 3 r ′′ ∂e XC ∂τ σ (r ′ ) δτ σ (r ′ ) δψ ikσ (r ′′ ) δψ ikσ (r ′′ ) δv S,σ (r 1 ) + c.c.. (9) Though a direct solution for the OEP is possible  18, 21  , it is both computationally expensive and numerically unstable. The common practice is to approximate the solution of Eq. (  9 ). Ref. 17 employed the local-Hartree-Fock (LHF)  22  approximation to derive approximated v τ -dep XC,σ of meta-GGA for finite systems. Here we do the derivation with the effective local potential (ELP)  23, 24  approximation. The ELP is equivalent to the LHF and the common-energy-denominator approximation (CEDA)  25, 26  , and the Krieger-Li-Iafrate (KLI)  27  approximation is their simplification. The ELP minimizes the matrix norm of the commutator S σ = [ Dσ , ρσ ], where Dσ = v τ -dep XC,σ -vgKS XC,σ , and ρσ = 1 ΩBZ i d 3 k θ iσ (k) |ψ ikσ ψ ikσ | is the spin density matrix. ρσ becomes valid for both the KS and the gKS system when S σ = 0. S σ is minimized when δS σ /δv τ -dep XC,σ (r) = 0, which yields the ELP approxima- tion of v τ -dep XC,σ : v τ ELP XC,σ (r) = 1 2Ω BZ n σ (r) BZ d 3 k i θ iσ (k)ψ * ikσ (r)v gKS XC,σ ψ ikσ (r) + 1 Ω BZ BZ d 3 k ′ ij θ iσ (k)θ jσ (k ′ )ψ * ikσ (r)ψ jk ′ σ (r) × ψ jk ′ σ Dσ ψ ikσ + c.c. ( 10 ) The ELP approximates the OEP in a least-squares sense  24  . Ref. 24 shows that the ELP approximation is equivalent to the CEDA, which reduces to the KLI approximation by setting i = j in Eq. (  10 )  25  . If only the first term of Eq. (  10 ) is kept, one obtains the so-called Slater approximation  28  .

B. Implementation in the BAND code
The most efficient methods for calculating periodic systems are pseudopotential methods with planewave basis sets, with the widely used PAW method as an extension  29, 30  , but the OEP is hard to implement in such codes. The sum over bands in Eq. (  10 ) also includes the core bands, which are not directly available in pseudopotential codes. Furthermore, the OEP is inherently incompatible with the PAW formalism. The charge density in the PAW formalism is composed of the pseudo-chargedensity, the on-site all-electron density, and the on-site pseudo-charge-density  29, 30  , and the xc energy and potential are partitioned into three parts accordingly, with each part only depending on the corresponding part of the density. However, the OEP of meta-GGA is hard to partition this way. Due to these obstacles, we implement the OEP meta-GGA in the BAND code  [31] [32] [33] [34] [35]  . BAND is an all-electron DFT code for periodic systems. It uses atom-centered numerical functions as the basis set. All the real-space integrations are done numerically on a Becke fuzzy-cell grid  36  . The BZ is discretized with the commonly used Monkhorst-Pack grid  37  , so the k-integrations of Eq. (  10 ) become sums over k-points in the irreducible Brillouin zone (IBZ): 1 Ω BZ d 3 k g iσ (k)θ iσ (k) = 1 N G IBZ k Ŝ w kf i kσ g iσ ( R-1 k) (11 ) where g iσ (k) is the contribution to the integral from the orbital ψ ikσ , f i kσ is the occupation number, w k is the weight of the k-point times the k-space integration weight in BAND  32  , N G is the total number of symmetry operations, Ŝ = { R, t} is the space-group symmetry operator, and R is the rotational part of Ŝ. The Dσ matrix elements in Eq. (  10 ) vanish for k = k ′ , since Dσ has the perodicity of the unit cell. Eq. (  10 ) is implemented in the BAND code as v τ ELP XC,σ (r) = 1 N G n σ (r) IBZ k Ŝ i w kf i kσ × ℜ - 1 2 ψ * i kσ (r) ∇ r ∂e XC ∂τ σ (r) • R-1 ∇ r ′ ψ i kσ (r ′ )| r ′ = Ŝr + ∂e XC ∂τ σ (r) tr R-1 • ∇ r ′ ⊗ ∇ r ′ ψ i kσ (r ′ ) • R r ′ = Ŝr + j f j kσ ψ * i kσ ( Ŝr)ψ j kσ ( Ŝr)(I ij kσ -J ij kσ ) , (12) where I and J are I ij kσ = V cell d 3 r ψ * i kσ (r)v τ ELP XC,σ (r)ψ j kσ (r), (13) J ij kσ = 1 2 V cell d 3 r ∂e XC ∂τ σ (r)∇ψ * i kσ (r) • ∇ψ j kσ (r), ( 14 ) and ∇ r ′ ⊗∇ r ′ ψ i kσ (r ′ ) denotes the Hessian matrix of ψ i kσ . The integrals are done as discrete sums on the real-space grid. The I ij kσ depend on v τ ELP XC,σ , which is unknown beforehand. They can be determined by solving linear equations  17  , but this is costly for perodic systems. Instead, we determine the I integrals and v τ ELP XC,σ iteratively by the following steps: 1. Set the I integrals to 0.

Calculate v τ ELP
XC,σ with Eq. (  12 ) using the I integrals of the last iteration.

Calculate the I integrals using the new
v τ ELP XC,σ . 4. Repeat step 2 and 3 if d 3 r v τ ELP(i) XC,σ (r) -v τ ELP(i-1) XC,σ (r) > T , where i is the iteration count, and T is the error tolerance. v τ ELP XC,σ is only determined up to an additive constant c, since v τ ELP XC,σ + c yields the same band structure. c has to be fixed for determining the convergence. The I integrals contain v τ ELP XC,σ , so their values include c. We fix c by requiring that the term of v τ ELP XC,σ containing the I integrals averages to 0, i.e. the constant c is determined by 1 V cell V cell d 3 r 1 N G n σ (r) IBZ k Ŝ i w kf i kσ j f j kσ × ψ * i kσ ( Ŝr)ψ j kσ ( Ŝr) I ij kσ + cδ ij = 0 (15) In practice, the iterative procedure converges after 200 iterations on average for T = 10 -10 . Ref. 26 finds that the total energies and orbital energies obtained from CEDA and KLI are very close for atoms and molecules. We find that the same is true for periodic systems. The ELP is equivalent to the CEDA  24  , and its total energy is always lower than that of the KLI, but the total energy differences and the KS gap differences of the materials in Table  I  between that of the ELP and that of the KLI are at most 1 meV. Since the improvement of the ELP over the KLI is insignificant, we only report the KLI results in the following.

III. RESULTS
We calculate the KS and gKS gaps of 20 semiconductors and insulators with the SCAN, meta-GGA made simple 2 (MS2)  38, 39  , meta-GGA made very simple (MVS)  40  and TPSS 41 meta-GGAs and the PBE  42  GGA, and the results are collected in Table  I . Ge, CdO, and InN are not listed since their calculated gaps vanish. All the calculations are done with the TZ2P basis set  43  . A 9 × 9 × 9 Monkhorst-Pack k-grid 37 is used for most of the materials except InN, CdS and CdSe, for which a 9×9×5 k-grid is used. We find that the OEP meta-GGA is sensitive to the real-space grid, and large grids are used to ensure convergence. The details of the grid problem are discussed in Section IV. Though GGA and gKS meta-GGA converge properly with smaller grids, we use the same grid as the OEP meta-GGA, so that the results are comparable. The scalar relativistic effect is included in the calculations by the ZORA  44  method. We ignore the spin-orbit coupling since the effect is small (0.03 eV for InP). The relativistic effect is implicitly included through the pseudopotential in planewave codes, but it needs to be explicitly included in BAND. We find that the scalar relativistic effect has a big impact on the KS and gKS gaps, since it shifts down the orbital energies of s-type bands, such as the lowest conduction band of GaAs  45  . The change in the KS and gKS gaps due to the scalar relativistic effect can be as big as 0.7 eV (GaAs). Figs. 1 and 2 compare the OEP of SCAN meta-GGA and the LDA and the PBE xc potentials for the Ne atom and bulk Si, respectively. The exact xc potential of the Ne atom  46  is plotted as a reference. The exact xc potential of Ne has a bump between the two shells of the charge density. The v XC of LDA does not have this feature. The v XC 's of PBE and SCAN both have this bump, and they are roughly in the same position as that of the exact v XC , but these v XC 's are shallower than the exact v XC . The v XC 's of SCAN also have a few small bumps that are not in the exact v XC . In the asymptotic region, the exact v XC decays as -1/r, and the v XC 's of all the semi-local functionals decay exponentially. Fig.  1  shows that the v XC of SCAN has the same decay as that of LDA and PBE. For periodic systems, there is no asymptotic region, and the approximated v XC 's of bulk Si in Fig.  2  can be expected to be closer to the exact v XC than those in Fig.  1 . In Fig.  2 , the v XC of SCAN are similar to the v XC of PBE, and they only differ in small details. Similar to Fig.  1 , the v XC 's of SCAN for bulk Si also have small bumps. Though the meta-GGA is a higher rung functional on the Jacob's ladder than the GGA, the improvement in v XC is small going from GGA to meta-GGA, unlike going from LDA to GGA. The differences between the KS meta-GGA gaps and the PBE gaps in Table I are small as a consequence. The band structures of Si and GaAs calculated with PBE and SCAN are plotted in Figs.  4  and 5 . The KS(KLI) SCAN band structure is very close to the PBE band structure, due to the corresponding v XC being similar to the PBE v XC . The gKS SCAN band structure has the same overall shape as that of the PBE and the  ). All energies are in eV. The experimental gaps are from Ref. 47. The BAs GW gap is from Ref. 48. The mean absolute errors (MAE) and mean absolute relative error (MARE) for the band gaps are listed. HSE  [49] [50] [51]  gaps calculated with the VASP 30,52-55 code are also listed for reference. The PBE and SCAN gaps of Ge, CdO, and InN are vanishing, so they are not listed. Their experimental gaps are 0.74 eV, 0.84 eV, and 1.95 eV, respectively. Their HSE gaps are 0.65 eV, 0.94 eV, and 0.77 eV, respectively. The KS(KLI) TPSS results are not listed as most calculations fail to converge. 

KS(KLI), and the main difference is in the band gap.
Though the gKS meta-GGA band gaps improve over the PBE gaps in general, it is disappointing that gKS meta-GGA gaps for Ge, InN, and CdO still vanish. However, it is possible for meta-GGAs to open the gap for The improvement of the band gap occurs since, unlike the KS gap, the gKS gap is an approximation to the fundamental gap of the meta-GGA. A Janak-type 59 theorem has been proven for the OEP  9  , and it states that the gKS gap approximately equals the fundamental gap for the same functional, assuming fixed orbitals. This assumption does not apply to finite systems, but it is true for periodic systems, since the charge density and the orbitals of a periodic system undergo only an infinitesimal change when the number of electrons changes by one. GGA band gaps should be compared with the OEP meta-GGA band gaps for a fair comparison between approximated functionals, since the OEP meta-GGA band gap is the KS gap. The SCAN functional is the only functional that satisfies all the known exact conditions, but the KS(KLI) SCAN gaps do not have significant improvements over the PBE gaps. This is probably due to the fact that the GGA and SCAN OEP gaps closely approximate the exact KS gap, which underestimates the fundamental gap. This has been illustrated in Fig.  3 , where the errors of the EXX+RPA(OEP) KS gaps 56 are also plotted. EXX+RPA (exact exchange plus random phase approximation for correlation) is a high-level (fifth rung) method, and its OEP gaps are expected to be very close to those of the corresponding exact KS potential. Fig.  3  shows that both PBE and KS SCAN gaps are already good approximations to the exact KS gap. Some of the gKS band gaps of MS2 and TPSS are smaller than the corresponding OEP band gaps. We do find this behavior in other functionals. Many of the KS(KLI) TPSS calculations fail to converge. This is probably a numerical issue in the calculation of ∇(∂e XC /∂τ σ ), due to the complicated functional form of TPSS. The energy functional of the exact DFT has derivative discontinuities ∆ XC at integer electron numbers  7  , where ∆ XC = E g -E KS g . The exact KS potential jumps up by the positive constant ∆ XC as the electron number crosses the value that makes the solid electrically neutral. LDA and GGA miss much or all of the derivative discontinuity due to the convexity of the approximated energy functional  60  , and they underestimate the gap as a consequence. In periodic systems, such discontinuities are only visible at band gaps. Though the derivative discontinuity has been thoroughly studied for atoms and molecules, it is difficult to obtain for periodic systems, since I and A cannot be calculated directly. With the OEP meta-GGA provided in this work, we are able to estimate the ∆ XC of solids. E g can be approximated by the derivative gap E deriv g = ∂E/∂N | N+ -∂E/∂N | N-, which is equal to the gKS meta-GGA gap  9, 60, 61  . E KS g is the OEP meta-GGA gap. The results are shown in Table  I . Comparison of the ∆ XC 's of meta-GGAs with the exact ∆ XC is impossible for periodic systems, since no exact KS potential is available. However, Ref. 62 provides an OEP of the GW method of bulk Si, and its ∆ XC can be seen as a good approximation to the exact ∆ XC . The ∆ XC of bulk Si in Ref. 62 is 0.58 eV, which is larger than that of all the meta-GGAs in Table  I . This is not unexpected because the meta-GGA's tested in this work are not exact for I -A in a solid.

IV. REAL-SPACE GRID DEPENDENCY
The gKS meta-GGA requires a larger real-space integration grid than GGA  63  , and this is caused by the sharp variation in regions far away from nuclei of quantities containing τ , such as z = τ W /τ used in TPSS, and α = (τ -τ W )/τ 0 used in SCAN, MS2 and MVS, where τ W = |∇n| 2 /(8n) is the von Wiezsäcker kinetic energy density, and τ 0 = (3/10)(3π 2 ) 2/3 n 5/3 is the kinetic energy density of the uniform electron gas. The Becke fuzzy-cell grid is used as the real-space integration grid in most of the DFT codes. It is constructed by combining atom- centered spherical grids. The radial part of the spherical grid is dense near the nuclei, and is sparse away from the nuclei. The integration weights for the grid points in the sparse region would be larger than those in the dense region. Therefore a function with sharp features in regions away from the nuclei cannot be properly represented on the grid, and the error of integrations involving this function would be large. One needs larger grids in gKS meta-GGA calculations than those used in GGA calculations. We find that the OEP meta-GGA is more sensitive to the real-space integration grid than the gKS meta-GGA. In the gKS case, the sensitivity to the grid shows up in the potential energy surface  63, 64  as spurious oscillations, but the sensitivity is not obvious in a single-point calculation. In the OEP case, a single-point calculation is enough to demonstrate the grid sensitivity by comparing the total energy. The total energy of the OEP meta-GGA variationally minimized with respect to the charge density, but the total energy of the gKS meta-GGA is variationally minimized with respect to the orbitals. Since the gKS has bigger variational degrees of freedom, the gKS total energy should always be lower than the OEP total energy, and both should be lower than the meta-GGA total energy evaluated with non-variational orbitals. However, though the built-in integration grids in the BAND code are good enough for gKS calculations, they are not sufficient for an OEP calculation: the OEP total energy calculated with these grids is always higher than the total energy evaluated with PBE orbitals. For example, the best built-in grid in BAND for the Ne atom has 120 radial points, but at least 266 radial points are required for the SCAN OEP total energy to be lower than the SCAN total energy evaluated with PBE orbitals, and 504 radial points are required for the SCAN OEP total energy to converge with respect to the grid (error<0.01 meV). The total energy is not sensitive to the number of angular grid points. Table II lists the total energy differences using different grids. The OEP v XC of the Ne atom, Ar 2 dimer, and bulk Si (along the Si-Si bond) are plotted in Figs.  6, 7 , and 8. The OEP v XC develops unnatural peaks close to nuclei when too few grid points are used. These peaks have a strong effect on the KS band gap and the total energy. For bulk Si with 134 points (dashed line in Fig.  8 ), the system becomes gapless. The grid-dependence of the OEP meta-GGA is caused by ∇∂e XC /∂τ σ in Eq. (  12 ). Figs. 6, 7, and 8 show that ∇∂e XC /∂τ σ has very sharp oscillations both close to and away from the nucleus. The dots in these plots show the grid point locations when the calculation is done with a built-in grid in BAND. These grid points are sufficient for an gKS meta-GGA calculation since they are dense enough to properly describe the oscillations in α, but they are insufficient for an OEP meta-GGA calculation since the peaks in ∇∂e XC /∂τ σ are much narrower than those of α. Fig.  9  shows ∇∂e XC /∂τ of the Ne atom for SCAN, TPSS, MS2, and MVS functionals. Though ∇∂e XC /∂τ of all functionals have oscillations, the sharpness of the peaks is different, and consequently the numbers of grid points required for convergence are also different: SCAN has very sharp peaks, and it requires 352 points to converge the total energy within 1% error; The peaks in MVS are broader, and it only requires 252 points to converge with the same error criterion. The oscillations in ∇∂e XC /∂τ for SCAN, MS2 and MVS are centered at or close to α = 1 in Fig.  9 . All these functionals use α to incorporate the kinetic energy density into the functional, and their energy densities all have the form e XC = e xc,1 + f (α)(e xc,0 -e xc,1 ), where e xc,0 and e xc,1 are e XC constructed for α = 0 and α = 1, and f (α) is an interpolation function that decreases mono- tonically with α from 1 at α = 0 to 0 at α = 1 to negative values for α > 1. The oscillation in ∇∂e XC /∂τ then implies a peak in df (α)/dα. α = 1 corresponds to the uniform electron gas limit, and the f (α) of SCAN and MS2 are constructed to have d 2 f (α)/dα 2 = 0 there to recover the gradient expansion approximation  38  . Therefore df (α)/dα has a flat-or linearly-topped peak at α = 1, which explains the oscillation. For MVS, d 2 f (α)/dα 2 vanishes at α = 0.77, and its oscillation in ∇∂e XC /∂τ occurs there. By choosing other functional forms for f (α), it is possible to get rid of the oscillations and the grid sensitivity. TPSS does not have this feature since it uses z instead of α. Even though a small grid cannot properly represent the oscillations in ∇∂e XC /∂τ , Fig.  10  shows that the v XC of the Slater approximation (which contains ∇∂e XC /∂τ explicitly) evaluated on a small grid is already similar to the KLI v XC evaluated on a big grid. The KLI approxiis supposed to be an improvement over the Slater approximation, but it introduces big errors in v XC when using a small grid. The grid sensitivity actually enters the OEP indirectly through the I integrals of Eq. (  14 ). Since the Slater term contains ∇∂e XC /∂τ , the I integrals cannot be done accurately with a small grid. The gKS meta-GGA potential operator in Eq. (  7 ) also contains ∇∂e XC /∂τ , but the grid sensitivity of gKS is much lower than that of OEP. There is no contradiction since ∇∂e XC /∂τ does not have to be evaluated directly in gKS meta-GGA. Using integration by parts, the matrix elements ψ ikσ vgKS XC,σ ψ jkσ becomes - 1 2 d 3 rψ * ikσ (r)∇ • ∂e XC ∂τ σ (r)∇ψ jkσ (r) = 1 2 d 3 r ∂e XC ∂τ σ (r)∇ψ * ikσ (r) • ∇ψ jkσ (r), (16) and ∂e XC /∂τ is less sensitive to the grid than ∇∂e XC /∂τ . The grid sensitivity of the OEP is also expected to show up in the time-dependent density-functional theory (TDDFT)  65  with a meta-GGA xc kernel. Aside from the grid problem, we find that the OEP meta-GGA in general needs more self-consistent-field (SCF) cycles to reach convergence than the gKS meta-GGA. For small gap materials, the OEPs of some meta-GGA functionals do not converge, while the corresponding gKS calculations converge normally. We tested SCAN, MS2, MVS, and TPSS functionals, and SCAN has the least convergence problem. 

V. CONCLUSION
In conclusion, we implemented the ELP and the KLI approximations for the OEP meta-GGA of periodic systems, with which we study the meta-GGA band gaps of 20 semiconductors and insulators. Comparing with the GGA band gaps, the new SCAN meta-GGA in a generalized Kohn-Sham scheme is found to improve the band gaps over the GGA band gaps. The non-empirical SCAN meta-GGA outperforms the nonempirical PBE GGA, not only for diversely-bonded materials near equilibrium  12  , but also for the band gaps of solids. The improvement is achieved without using the expensive exact exchange, as in fourth-rung hybrid functionals. For materials wrongly predicted to be gapless in GGA, the result 57 of β-MnO 2 with SCAN shows that meta-GGAs can open the gap. Consider the ratio of the calculated to the experimental energy gap. For the 17 solids of Table  I , this ratio varies from 0.35 to 0.79 with an average of 0.60 for the PBE GGA, from 0.53 to 0.94 with an average of 0.73 for the SCAN meta-GGA, and from 0.72 to 1.07 with an average of 0.89 for the HSE hybrid functional. The ratio improves uniformly from PBE to SCAN to HSE. While the hybrid functional is more accurate for the gap than SCAN is, it is also more empirical and more computationally expensive. For periodic systems, the OEP or ungeneralized Kohn-Sham v XC 's of meta-GGAs are close to the GGA v XC 's, and they only differ in small details. Consequently the OEP meta-GGA gaps (like the OEP EXX+RPA gaps where available) are not improved significantly over the GGA gaps, and the band structures of OEP meta-GGAs are similar to those of GGAs. We think it is likely that the band gap and band structure in the exact Kohn-Sham potential are close to those of GGA and OEP meta-GGA (and of the OEP hybrid) in periodic systems. Aside from the band gap, the gKS meta-GGA band structures are also similar to the GGA band structures. Due to the sharp features in ∇∂e XC /∂τ σ , the OEP meta-GGA is sensitive to the real-space grid used in computation, more so than the gKS meta-GGA. Different meta-GGAs have different requirements for the minimal grid, and in general SCAN needs the biggest grid to converge of the meta-GGAs tested in this work. TDDFT with meta-GGA xc kernels is also expected to show this grid sensitivity. It is possible to avoid the grid sensitivity in the design of the functional, although this may interfere with the satisfaction of some exact conditions.